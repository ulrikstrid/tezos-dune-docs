<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Protocol (tezt-tezos.Tezt_tezos.Protocol)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">tezt-tezos</a> &#x00BB; <a href="../index.html">Tezt_tezos</a> &#x00BB; Protocol</nav><h1>Module <code>Tezt_tezos.Protocol</code></h1></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code><code> = </code><table class="variant"><tr id="type-t.Edo" class="anchored"><td class="def constructor"><a href="#type-t.Edo" class="anchor"></a><code>| </code><code><span class="constructor">Edo</span></code></td></tr><tr id="type-t.Florence" class="anchored"><td class="def constructor"><a href="#type-t.Florence" class="anchor"></a><code>| </code><code><span class="constructor">Florence</span></code></td></tr><tr id="type-t.Alpha" class="anchored"><td class="def constructor"><a href="#type-t.Alpha" class="anchor"></a><code>| </code><code><span class="constructor">Alpha</span></code></td></tr></table></dt><dd><p>Protocols we may want to test with.</p></dd></dl><dl><dt class="spec type" id="type-constants"><a href="#type-constants" class="anchor"></a><code><span class="keyword">type</span> constants</code><code> = </code><table class="variant"><tr id="type-constants.Constants_sandbox" class="anchored"><td class="def constructor"><a href="#type-constants.Constants_sandbox" class="anchor"></a><code>| </code><code><span class="constructor">Constants_sandbox</span></code></td></tr><tr id="type-constants.Constants_mainnet" class="anchored"><td class="def constructor"><a href="#type-constants.Constants_mainnet" class="anchor"></a><code>| </code><code><span class="constructor">Constants_mainnet</span></code></td></tr><tr id="type-constants.Constants_test" class="anchored"><td class="def constructor"><a href="#type-constants.Constants_test" class="anchor"></a><code>| </code><code><span class="constructor">Constants_test</span></code></td></tr></table></dt><dd><p>Protocol parameters.</p><p>These values denote which file to use from the <code>&quot;parameters&quot;</code> directory.</p></dd></dl><dl><dt class="spec value" id="val-default_constants"><a href="#val-default_constants" class="anchor"></a><code><span class="keyword">val</span> default_constants : <a href="index.html#type-constants">constants</a></code></dt><dd><p>The default constants used by tests: <code>Constants_sandbox</code>.</p></dd></dl><dl><dt class="spec value" id="val-name"><a href="#val-name" class="anchor"></a><code><span class="keyword">val</span> name : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Get the name of a protocol, capitalized (e.g. <code>&quot;Edo&quot;</code>).</p></dd></dl><dl><dt class="spec value" id="val-tag"><a href="#val-tag" class="anchor"></a><code><span class="keyword">val</span> tag : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Get the name of a protocol as a tag, for use when registering tests (e.g. <code>&quot;edo&quot;</code>).</p></dd></dl><dl><dt class="spec value" id="val-hash"><a href="#val-hash" class="anchor"></a><code><span class="keyword">val</span> hash : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Get the full hash of a protocol.</p></dd></dl><dl><dt class="spec value" id="val-parameter_file"><a href="#val-parameter_file" class="anchor"></a><code><span class="keyword">val</span> parameter_file : <span>?&#8288;constants:<a href="index.html#type-constants">constants</a></span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Get the location of the parameter file.</p><p>This returns the path to one of the parameter files of the <code>&quot;parameters&quot;</code> directory of the protocol, relative to the root of the repository.</p></dd></dl><dl><dt class="spec value" id="val-accuser"><a href="#val-accuser" class="anchor"></a><code><span class="keyword">val</span> accuser : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Get the path of the accuser of a protocol, such as <code>&quot;./tezos-accuser-alpha&quot;</code>.</p></dd></dl><dl><dt class="spec value" id="val-daemon_name"><a href="#val-daemon_name" class="anchor"></a><code><span class="keyword">val</span> daemon_name : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Get the part of the daemon name that is specific to a protocol (e.g. <code>&quot;008-PtEdo2Zk&quot;</code>).</p></dd></dl><dl><dt class="spec value" id="val-encoding_prefix"><a href="#val-encoding_prefix" class="anchor"></a><code><span class="keyword">val</span> encoding_prefix : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Get the part which is added at the beginning of all encoding names.</p><p>It turns out this is equal to what the <code>daemon_name</code> function returns.</p></dd></dl><dl><dt class="spec type" id="type-parameter_overrides"><a href="#type-parameter_overrides" class="anchor"></a><code><span class="keyword">type</span> parameter_overrides</code><code> = <span><span>(<span>string list</span> * <span>string option</span>)</span> list</span></code></dt><dd><p>Values to override in protocol parameters.</p><p>The are pairs of JSON paths and optional values that can be used to override or remove (when the value is <code>None</code>) the default parameters when activating protocol.</p></dd></dl><dl><dt class="spec value" id="val-write_parameter_file"><a href="#val-write_parameter_file" class="anchor"></a><code><span class="keyword">val</span> write_parameter_file : <span>protocol:<a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <a href="index.html#type-parameter_overrides">parameter_overrides</a> <span>&#45;&gt;</span> <span>string Lwt.t</span></code></dt><dd><p>Write a protocol parameter file.</p><p>Default values are used, except for values given as <code>parameter_overrides</code>.</p></dd></dl><dl><dt class="spec value" id="val-next_protocol"><a href="#val-next_protocol" class="anchor"></a><code><span class="keyword">val</span> next_protocol : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="index.html#type-t">t</a> option</span></code></dt><dd><p>Get the successor of a protocol.</p><p>WARNING: use of this function is discouraged, because:</p><ul><li>a protocol may have several possible successors;</li><li>it prevents the type-checker from telling you that your test can no longer run when removing a protocol.</li></ul></dd></dl><dl><dt class="spec value" id="val-previous_protocol"><a href="#val-previous_protocol" class="anchor"></a><code><span class="keyword">val</span> previous_protocol : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="index.html#type-t">t</a> option</span></code></dt><dd><p>Get the predecessor of a protocol.</p><p>WARNING: use of this function is discouraged, because it prevents the type-checker from telling you that your test can no longer run when removing a protocol.</p></dd></dl><dl><dt class="spec value" id="val-all"><a href="#val-all" class="anchor"></a><code><span class="keyword">val</span> all : <span><a href="index.html#type-t">t</a> list</span></code></dt><dd><p>Get the list of all protocols.</p><p>WARNING: use of this function is discouraged, because:</p><ul><li>if we add protocols such as demo-noop or demo-counter to type <code>t</code>, it would be awkward to add them to <code>all</code> if <code>all</code> only contained &quot;real&quot; protocols up to now, and it would also be awkward not to add them to <code>all</code>;</li><li>it is easier for maintainers if the list of protocols a test runs on is clearly defined where the test is registered.</li></ul></dd></dl><dl><dt class="spec value" id="val-current_mainnet"><a href="#val-current_mainnet" class="anchor"></a><code><span class="keyword">val</span> current_mainnet : <a href="index.html#type-t">t</a></code></dt><dd><p>The protocol that is currently active on Mainnet.</p><p>Use this when registering tests that are not expected to break in future protocols.</p></dd></dl><dl><dt class="spec value" id="val-register_test"><a href="#val-register_test" class="anchor"></a><code><span class="keyword">val</span> register_test : <span>__FILE__:string</span> <span>&#45;&gt;</span> <span>title:string</span> <span>&#45;&gt;</span> <span>tags:<span>string list</span></span> <span>&#45;&gt;</span> <span>(<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>unit Lwt.t</span>)</span> <span>&#45;&gt;</span> <span>protocols:<span><a href="index.html#type-t">t</a> list</span></span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Register a test that uses the protocol.</p><p>This is the same as <code>Test.register</code> except that:</p><ul><li>the name of the protocol is automatically added at the beginning of <code>title</code>;</li><li>the name of the protocol is automatically added as a tag in <code>tags</code>;</li><li>the function that implements the test takes a protocol as parameter;</li><li>an additional parameter gives the list of protocols to run the test on.</li></ul><p>The list of protocol is the last parameter because this function is intended to be applied partially, without this list; the test function being the parameter of type <code>t -&gt; unit Lwt.t</code> before the list. The list of protocols is specified in <code>main.ml</code>, next to the registration of all other tests, so that it is easy to see at a glance which tests run on which protocols.</p><p>If your test involves several protocols (for instance to test migration), use <code>Test.register</code> directly.</p></dd></dl><dl><dt class="spec value" id="val-register_regression_test"><a href="#val-register_regression_test" class="anchor"></a><code><span class="keyword">val</span> register_regression_test : <span>__FILE__:string</span> <span>&#45;&gt;</span> <span>title:string</span> <span>&#45;&gt;</span> <span>tags:<span>string list</span></span> <span>&#45;&gt;</span> <span>output_file:string</span> <span>&#45;&gt;</span> <span>?&#8288;regression_output_path:string</span> <span>&#45;&gt;</span> <span>(<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>unit Lwt.t</span>)</span> <span>&#45;&gt;</span> <span>protocols:<span><a href="index.html#type-t">t</a> list</span></span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Register a regression test that uses the protocol.</p><p>This is the same as <code>Regression.register</code>, with the same differences as <code>Protocol.register_test</code> compared to <code>Test.register</code>.</p></dd></dl></div></body></html>