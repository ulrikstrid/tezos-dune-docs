<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>JSON (tezt.Tezt.JSON)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../index.html">tezt</a> &#x00BB; <a href="../index.html">Tezt</a> &#x00BB; JSON</nav><h1>Module <code>Tezt.JSON</code></h1><nav class="toc"><ul><li><a href="#encoding">Encoding</a></li><li><a href="#decoding">Decoding</a></li></ul></nav></header><aside><p>JSON decoding.</p></aside><dl><dt class="spec type" id="type-error"><a href="#type-error" class="anchor"></a><code><span class="keyword">type</span> error</code></dt><dd><p>Errors that can happen when parsing or reading JSON.</p></dd></dl><dl><dt class="spec value" id="val-show_error"><a href="#val-show_error" class="anchor"></a><code><span class="keyword">val</span> show_error : <a href="index.html#type-error">error</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Convert a JSON parse error to a string.</p></dd></dl><dl><dt class="spec exception" id="exception-Error"><a href="#exception-Error" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Error</span> <span class="keyword">of</span> <a href="index.html#type-error">error</a></code></dt><dd><p>Exception that can happen when parsing or reading JSON.</p></dd></dl><dl><dt class="spec type" id="type-u"><a href="#type-u" class="anchor"></a><code><span class="keyword">type</span> u</code><code> = Ezjsonm.value</code></dt><dd><p>JSON unannotated ASTs.</p></dd></dl><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt><dd><p>JSON ASTs annotated with their origin.</p><p>The origin is a string you give to <a href="index.html#val-annotate"><code>annotate</code></a> or <a href="index.html#val-parse"><code>parse</code></a>, such as <code>&quot;RPC response&quot;</code>. It denotes where the value comes from. It is used in error messages (see the comment in the Decoding section).</p></dd></dl><dl><dt class="spec value" id="val-annotate"><a href="#val-annotate" class="anchor"></a><code><span class="keyword">val</span> annotate : <span>origin:string</span> <span>&#45;&gt;</span> <a href="index.html#type-u">u</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Annotate a JSON AST with its origin.</p></dd></dl><dl><dt class="spec value" id="val-unannotate"><a href="#val-unannotate" class="anchor"></a><code><span class="keyword">val</span> unannotate : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-u">u</a></code></dt><dd><p>Remove annotation from an annotated JSON AST.</p></dd></dl><section><header><h3 id="encoding"><a href="#encoding" class="anchor"></a>Encoding</h3></header><dl><dt class="spec value" id="val-encode"><a href="#val-encode" class="anchor"></a><code><span class="keyword">val</span> encode : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Encode a JSON annotated AST into a string.</p></dd></dl><dl><dt class="spec value" id="val-encode_u"><a href="#val-encode_u" class="anchor"></a><code><span class="keyword">val</span> encode_u : <a href="index.html#type-u">u</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Encode a JSON unannotated AST into a string.</p></dd></dl></section><section><header><h3 id="decoding"><a href="#decoding" class="anchor"></a>Decoding</h3></header><dl><dt class="spec value" id="val-parse_file"><a href="#val-parse_file" class="anchor"></a><code><span class="keyword">val</span> parse_file : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Parse a JSON file.</p><dl><dt>raises [Error]</dt><dd><p>if the input is invalid JSON.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-parse"><a href="#val-parse" class="anchor"></a><code><span class="keyword">val</span> parse : <span>origin:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Parse a JSON string.</p><dl><dt>raises [Error]</dt><dd><p>if the input is invalid JSON.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-parse_opt"><a href="#val-parse_opt" class="anchor"></a><code><span class="keyword">val</span> parse_opt : <span>origin:string</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><a href="index.html#type-t">t</a> option</span></code></dt><dd><p>Same as <code>parse</code>, but return <code>None</code> instead of raising <code>Error</code>.</p></dd></dl><aside><p>The general pattern for the accessors below is that only <code>as_x</code> functions can fail. Getters <code>get</code> and <code>geti</code> return <code>`Null</code> instead of failing. This allows to chain them and only test for errors at the end with <code>as_x</code>, either by raising <code>Error</code> or by returning <code>None</code> (with the <code>as_x_opt</code> variant).</p><p>Internally, the actual error which is printed is the correct one. For instance, with <code>json |-&gt; &quot;x&quot; |&gt; as_int</code>, if <code>json</code> is not an object, the call to <code>as_int</code> causes the test to fail with <code>&quot;&lt;origin&gt;: not an object&quot;</code> where <code>&lt;origin&gt;</code> is the <code>~origin</code> you gave to <a href="index.html#val-parse"><code>parse</code></a>. If <code>json</code> is an object but <code>&quot;x&quot;</code> does not exist, <code>as_int</code> causes the test to fail with <code>&quot;&lt;origin&gt;: missing field: x&quot;</code>. If <code>&quot;x&quot;</code> exists but is not an integer, <code>as_int</code> causes the test to fail with <code>&quot;&lt;origin&gt; at .x: expected an integer&quot;</code>.</p></aside><dl><dt class="spec value" id="val-get"><a href="#val-get" class="anchor"></a><code><span class="keyword">val</span> get : string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Get the value for a field of a JSON object.</p><p>If the JSON value is not an object, or if the field does not exist, return <code>`Null</code>.</p></dd></dl><dl><dt class="spec value" id="val-(|-&gt;)"><a href="#val-(|-&gt;)" class="anchor"></a><code><span class="keyword">val</span> (|-&gt;) : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Same as <a href="index.html#val-get"><code>get</code></a>, with the arguments reversed.</p></dd></dl><dl><dt class="spec value" id="val-geti"><a href="#val-geti" class="anchor"></a><code><span class="keyword">val</span> geti : int <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Get the value for a field of a JSON array.</p><p>If the JSON value is not an array, or if the field does not exist, return <code>`Null</code>.</p></dd></dl><dl><dt class="spec value" id="val-(|=&gt;)"><a href="#val-(|=&gt;)" class="anchor"></a><code><span class="keyword">val</span> (|=&gt;) : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Same as <a href="index.html#val-geti"><code>geti</code></a>, with the arguments reversed.</p></dd></dl><dl><dt class="spec value" id="val-put"><a href="#val-put" class="anchor"></a><code><span class="keyword">val</span> put : <span>(string * <a href="index.html#type-t">t</a>)</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Updates an object with a <code>(key, value)</code> pair.</p><p><code>put (key, value) obj</code> puts <code>value</code> under <code>key</code> in <code>obj</code>. If the <code>key</code> already exists, it is overwritten. Otherwise a new key is added at the end of the object.</p><dl><dt>raises [Error]</dt><dd><p>if <code>obj</code> is not a JSON object.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-update"><a href="#val-update" class="anchor"></a><code><span class="keyword">val</span> update : string <span>&#45;&gt;</span> <span>(<a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a>)</span> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Alters the value of a specific key in a JSON object by applying its value to a function. Returns updated object.</p><p><code>update key f obj</code> is equivalent to <code>put (key, f (get key obj)) obj</code>.</p><p>Note: if <code>key</code> is not present in <code>obj</code>, <code>`Null</code> is passed to <code>f</code> instead.</p><dl><dt>raises [Error]</dt><dd><p>if <code>obj</code> is not an object.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-is_null"><a href="#val-is_null" class="anchor"></a><code><span class="keyword">val</span> is_null : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Test whether a JSON value is <code>`Null</code>.</p></dd></dl><dl><dt class="spec value" id="val-as_bool"><a href="#val-as_bool" class="anchor"></a><code><span class="keyword">val</span> as_bool : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Get the value from a <code>`Bool</code> node.</p><dl><dt>raises [Error]</dt><dd><p>if the input is not a <code>`Bool</code>.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-as_bool_opt"><a href="#val-as_bool_opt" class="anchor"></a><code><span class="keyword">val</span> as_bool_opt : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>bool option</span></code></dt><dd><p>Same as <code>as_bool</code>, but return <code>None</code> instead of raising <code>Error</code>.</p></dd></dl><dl><dt class="spec value" id="val-is_bool"><a href="#val-is_bool" class="anchor"></a><code><span class="keyword">val</span> is_bool : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Test whether <code>as_bool</code> would succeed.</p></dd></dl><dl><dt class="spec value" id="val-as_int"><a href="#val-as_int" class="anchor"></a><code><span class="keyword">val</span> as_int : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int</code></dt><dd><p>Get the integer value from a <code>`Float</code> or <code>`String</code> node.</p><dl><dt>raises [Error]</dt><dd><p>if:</p><ul><li>the input is not a <code>`Float</code> nor a <code>`String</code>;</li><li>the input is a <code>`Float</code> but is not an integer;</li><li>the input is a <code>`String</code> but does not denote a valid decimal integer.</li></ul></dd></dl></dd></dl><dl><dt class="spec value" id="val-as_int_opt"><a href="#val-as_int_opt" class="anchor"></a><code><span class="keyword">val</span> as_int_opt : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>int option</span></code></dt><dd><p>Same as <code>as_int</code>, but return <code>None</code> instead of raising <code>Error</code>.</p></dd></dl><dl><dt class="spec value" id="val-is_int"><a href="#val-is_int" class="anchor"></a><code><span class="keyword">val</span> is_int : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Test whether <code>as_int</code> would succeed.</p></dd></dl><dl><dt class="spec value" id="val-as_int64"><a href="#val-as_int64" class="anchor"></a><code><span class="keyword">val</span> as_int64 : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int64</code></dt><dd><p>Get the integer value from a <code>`Float</code> or <code>`String</code> node (64-bit version).</p><dl><dt>raises [Error]</dt><dd><p>if:</p><ul><li>the input is not a <code>`Float</code> nor a <code>`String</code>;</li><li>the input is a <code>`Float</code> but is not an integer;</li><li>the input is a <code>`String</code> but does not denote a valid decimal integer.</li></ul></dd></dl></dd></dl><dl><dt class="spec value" id="val-as_int64_opt"><a href="#val-as_int64_opt" class="anchor"></a><code><span class="keyword">val</span> as_int64_opt : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>int64 option</span></code></dt><dd><p>Same as <code>as_int64</code>, but return <code>None</code> instead of raising <code>Error</code>.</p></dd></dl><dl><dt class="spec value" id="val-is_int64"><a href="#val-is_int64" class="anchor"></a><code><span class="keyword">val</span> is_int64 : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Test whether <code>as_int64</code> would succeed.</p></dd></dl><dl><dt class="spec value" id="val-as_float"><a href="#val-as_float" class="anchor"></a><code><span class="keyword">val</span> as_float : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> float</code></dt><dd><p>Get the float value from a <code>`Float</code> or <code>`String</code> node.</p><dl><dt>raises [Error]</dt><dd><p>if:</p><ul><li>the input is not a <code>`Float</code> nor a <code>`String</code>;</li><li>the input is a <code>`String</code> but does not denote a valid decimal float.</li></ul></dd></dl></dd></dl><dl><dt class="spec value" id="val-as_float_opt"><a href="#val-as_float_opt" class="anchor"></a><code><span class="keyword">val</span> as_float_opt : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>float option</span></code></dt><dd><p>Same as <code>as_float</code>, but return <code>None</code> instead of raising <code>Error</code>.</p></dd></dl><dl><dt class="spec value" id="val-is_float"><a href="#val-is_float" class="anchor"></a><code><span class="keyword">val</span> is_float : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Test whether <code>as_float</code> would succeed.</p></dd></dl><dl><dt class="spec value" id="val-as_string"><a href="#val-as_string" class="anchor"></a><code><span class="keyword">val</span> as_string : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Get the value from a <code>`String</code> node.</p><dl><dt>raises [Error]</dt><dd><p>if the input is not a <code>`String</code>.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-as_string_opt"><a href="#val-as_string_opt" class="anchor"></a><code><span class="keyword">val</span> as_string_opt : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>string option</span></code></dt><dd><p>Same as <code>as_string</code>, but return <code>None</code> instead of raising <code>Error</code>.</p></dd></dl><dl><dt class="spec value" id="val-is_string"><a href="#val-is_string" class="anchor"></a><code><span class="keyword">val</span> is_string : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Test whether <code>as_string</code> would succeed.</p></dd></dl><dl><dt class="spec value" id="val-as_list"><a href="#val-as_list" class="anchor"></a><code><span class="keyword">val</span> as_list : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><a href="index.html#type-t">t</a> list</span></code></dt><dd><p>Get the list of items from an <code>`Array</code> node.</p><dl><dt>raises [Error]</dt><dd><p>if the input is not an <code>`Array</code> nor <code>`Null</code>. Return the empty list if the input is <code>`Null</code>.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-as_list_opt"><a href="#val-as_list_opt" class="anchor"></a><code><span class="keyword">val</span> as_list_opt : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span><a href="index.html#type-t">t</a> list</span> option</span></code></dt><dd><p>Same as <code>as_list</code>, but return <code>None</code> instead of raising <code>Error</code>.</p></dd></dl><dl><dt class="spec value" id="val-is_list"><a href="#val-is_list" class="anchor"></a><code><span class="keyword">val</span> is_list : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Test whether <code>as_list</code> would succeed.</p></dd></dl><dl><dt class="spec value" id="val-as_object"><a href="#val-as_object" class="anchor"></a><code><span class="keyword">val</span> as_object : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span>(string * <a href="index.html#type-t">t</a>)</span> list</span></code></dt><dd><p>Get the list of fields from an <code>`Object</code> node.</p><dl><dt>raises [Error]</dt><dd><p>if the input is not an <code>`Object</code> nor <code>`Null</code>. Return the empty list if the input is <code>`Null</code>.</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-as_object_opt"><a href="#val-as_object_opt" class="anchor"></a><code><span class="keyword">val</span> as_object_opt : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span><span><span>(string * <a href="index.html#type-t">t</a>)</span> list</span> option</span></code></dt><dd><p>Same as <code>as_object</code>, but return <code>None</code> instead of raising <code>Error</code>.</p></dd></dl><dl><dt class="spec value" id="val-is_object"><a href="#val-is_object" class="anchor"></a><code><span class="keyword">val</span> is_object : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Test whether <code>as_object</code> would succeed.</p></dd></dl></section></div></body></html>