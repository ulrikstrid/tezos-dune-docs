<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Regression (tezt.Tezt.Regression)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">tezt</a> &#x00BB; <a href="../index.html">Tezt</a> &#x00BB; Regression</nav><header class="odoc-preamble"><h1>Module <code><span>Tezt.Regression</span></code></h1><p>Run Tezt regression tests and capture their output.</p><p>NOTE: consider using dune cram when it becomes available: https://dune.readthedocs.io/en/stable/tests.html#cram-tests</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value" id="val-register" class="anchored"><a href="#val-register" class="anchor"></a><code><span><span class="keyword">val</span> register : <span>__FILE__:string <span class="arrow">&#45;&gt;</span></span> <span>title:string <span class="arrow">&#45;&gt;</span></span> <span>tags:<span>string list</span> <span class="arrow">&#45;&gt;</span></span>
<span>output_file:string <span class="arrow">&#45;&gt;</span></span> <span>?regression_output_path:string <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Register a regression test.</p><p>This function is a wrapper around <code>Test.register</code>. It adds the &quot;regression&quot; tag to the <code>tags</code> list provided by the argument.</p><p>The <code>output_file</code> is a filename, where the output of the test is stored and read to be compared on subsequent runs. The output file with &quot;.out&quot; filename extension added is placed in the <code>regression_output_path</code>, which is by default &quot;tezt/_regressions&quot;.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-capture" class="anchored"><a href="#val-capture" class="anchor"></a><code><span><span class="keyword">val</span> capture : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Capture some output of a regression test.</p><p>Call this to record a string into the <code>output_file</code> given to <code>register</code>. A newline character <code>\n</code> will be added after it.</p><p>This function only records its argument when called while a regression test is running, i.e. from the body of <code>Regression.register</code>. If you call it outside of <code>Regression.register</code>, it has no effect. So you can define a function that captures and use it with or without regression testing.</p><p>A typical use is to define custom process hooks that substitute non-deterministic parts of the output with deterministic ones. See also <a href="#val-hooks"><code>hooks</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-hooks" class="anchored"><a href="#val-hooks" class="anchor"></a><code><span><span class="keyword">val</span> hooks : <a href="../Process/index.html#type-hooks">Process.hooks</a></span></code></div><div class="spec-doc"><p>Hooks that enable regression testing when attached to a process ran from a <a href="#val-register"><code>register</code></a>ed regression test function.</p><p>The hooks will <a href="#val-capture"><code>capture</code></a> the spawned command, its arguments and the output of its execution into the registered <code>output_file</code>.</p></div></div></div></body></html>