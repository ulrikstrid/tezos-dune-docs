<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Tezos_p2p__P2p_discovery (tezos-p2p.Tezos_p2p__P2p_discovery)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">tezos-p2p</a> &#x00BB; Tezos_p2p__P2p_discovery</nav><h1>Module <code>Tezos_p2p__P2p_discovery</code></h1><p>Local peer discovery.</p><p>This module manages the discovery of local peers through UDP broadcasting. It is composed of two workers:</p><ul><li>The sender worker whose role is to broadcast discovery messages.</li><li>The answer worker whose role is to listen discovery messages and register new peers in the current pool. Discovery messages are composed of an arbitrary key, the listening port and the peer id of the current peer.</li></ul></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt><dd><p>Type of a discovery worker.</p></dd></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : <span>listening_port:int</span> <span>&#45;&gt;</span> <span>discovery_port:int</span> <span>&#45;&gt;</span> <span>discovery_addr:Ipaddr.V4.t</span> <span>&#45;&gt;</span> <span>trust_discovered_peers:bool</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'b</span>, <span class="type-var">'c</span>)</span> <a href="../Tezos_p2p/P2p_pool/index.html#type-t">Tezos_p2p.P2p_pool.t</a></span> <span>&#45;&gt;</span> <a href="../../tezos-base/Tezos_base__P2p_peer_id/Table/index.html#type-key">Tezos_base__TzPervasives.P2p_peer.Table.key</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p><code>create ~listening_port ~discovery_port ~discovery_addr pool peer_id</code> returns a discovery worker registering local peers to the <code>pool</code> and broadcasting discovery messages with the <code>peer_id</code> and the <code>listening_port</code> through the address <code>discovery_addr:discovery_port</code>.</p></dd></dl><dl><dt class="spec value" id="val-activate"><a href="#val-activate" class="anchor"></a><code><span class="keyword">val</span> activate : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-wakeup"><a href="#val-wakeup" class="anchor"></a><code><span class="keyword">val</span> wakeup : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>wakeup t</code> sends a signal to the sender machine of <code>t</code>, asking it to immediately proceed to broadcasting.</p></dd></dl><dl><dt class="spec value" id="val-shutdown"><a href="#val-shutdown" class="anchor"></a><code><span class="keyword">val</span> shutdown : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <span>unit Lwt.t</span></code></dt><dd><p><code>shutdown t</code> returns when <code>t</code> has completed shutdown.</p></dd></dl></div></body></html>