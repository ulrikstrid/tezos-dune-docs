<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Client_baking_forge (tezos-baking-008-PtEdo2Zk.Tezos_baking_008_PtEdo2Zk.Client_baking_forge)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">tezos-baking-008-PtEdo2Zk</a> &#x00BB; <a href="../index.html">Tezos_baking_008_PtEdo2Zk</a> &#x00BB; Client_baking_forge</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_baking_008_PtEdo2Zk.Client_baking_forge</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value" id="val-generate_seed_nonce" class="anchored"><a href="#val-generate_seed_nonce" class="anchor"></a><code><span><span class="keyword">val</span> generate_seed_nonce : <span>unit <span class="arrow">&#45;&gt;</span></span> <a href="../../../tezos-protocol-008-PtEdo2Zk/Tezos_raw_protocol_008_PtEdo2Zk/Alpha_context/Nonce/index.html#type-t">Tezos_protocol_008_PtEdo2Zk.Protocol.Alpha_context.Nonce.t</a></span></code></div><div class="spec-doc"><p><code>generate_seed_nonce ()</code> is a random nonce that is typically used in block headers. When baking, bakers generate random nonces whose hash is committed in the block they bake. They will typically reveal the aforementioned nonce during the next cycle.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-inject_block" class="anchored"><a href="#val-inject_block" class="anchor"></a><code><span><span class="keyword">val</span> inject_block : <span><span class="xref-unresolved">Tezos_client_008_PtEdo2Zk</span>.Protocol_client_context.#full <span class="arrow">&#45;&gt;</span></span> <span>?force:bool <span class="arrow">&#45;&gt;</span></span>
<span>?seed_nonce_hash:<a href="../../../tezos-protocol-008-PtEdo2Zk/Tezos_raw_protocol_008_PtEdo2Zk/Nonce_hash/index.html#type-t">Tezos_protocol_008_PtEdo2Zk.Protocol.Nonce_hash.t</a> <span class="arrow">&#45;&gt;</span></span> <span>chain:<a href="../../../tezos-shell-services/Tezos_shell_services/Chain_services/index.html#type-chain">Tezos_shell_services.Chain_services.chain</a> <span class="arrow">&#45;&gt;</span></span> <span>shell_header:<a href="../../../tezos-protocol-008-PtEdo2Zk/Tezos_raw_protocol_008_PtEdo2Zk/Alpha_context/Block_header/index.html#type-shell_header">Tezos_protocol_008_PtEdo2Zk.Protocol.Alpha_context.Block_header.shell_header</a> <span class="arrow">&#45;&gt;</span></span> <span>priority:int <span class="arrow">&#45;&gt;</span></span> <span>delegate_pkh:<a href="../../../tezos-crypto/Tezos_crypto/Signature/Public_key_hash/index.html#type-t">Tezos_crypto.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
<span>delegate_sk:<a href="../../../tezos-client-base/Tezos_client_base/Client_keys/index.html#type-sk_uri">Tezos_client_base.Client_keys.sk_uri</a> <span class="arrow">&#45;&gt;</span></span> <span>level:<a href="../../../tezos-protocol-008-PtEdo2Zk/Tezos_raw_protocol_008_PtEdo2Zk/Alpha_context/Raw_level/index.html#type-t">Tezos_protocol_008_PtEdo2Zk.Protocol.Alpha_context.Raw_level.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span><a href="../../../tezos-protocol-008-PtEdo2Zk/Tezos_raw_protocol_008_PtEdo2Zk/Alpha_context/Operation/index.html#type-raw">Tezos_protocol_008_PtEdo2Zk.Protocol.Alpha_context.Operation.raw</a> list</span> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<a href="../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a>, <span><a href="../../../tezos-error-monad/Tezos_error_monad/TzCore/index.html#type-error">Tezos_error_monad.TzCore.error</a> list</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>inject_block cctxt blk ?force ~priority ~timestamp ~fitness
    ~seed_nonce ~src_sk ops</code> tries to inject a block in the node. If <code>?force</code> is set, the fitness check will be bypassed. <code>priority</code> will be used to compute the baking slot (level is precomputed). <code>src_sk</code> is used to sign the block header.</p></div></div><div class="odoc-spec"><div class="spec type extension"><code><span><span class="keyword">type</span> <span class="xref-unresolved">Tezos_base__TzPervasives.error</span> += </span></code><table><tr id="extension-Failed_to_preapply" class="anchored"><td class="def extension"><a href="#extension-Failed_to_preapply" class="anchor"></a><code><span>| </span><span><span class="extension">Failed_to_preapply</span> <span class="keyword">of</span> <a href="../../../tezos-base/Tezos_base/Operation/index.html#type-t">Tezos_base.Operation.t</a> * <span><a href="../../../tezos-error-monad/Tezos_error_monad/TzCore/index.html#type-error">Tezos_error_monad.TzCore.error</a> list</span></span></code></td></tr></table></div></div><div class="odoc-spec"><div class="spec value" id="val-forge_block" class="anchored"><a href="#val-forge_block" class="anchor"></a><code><span><span class="keyword">val</span> forge_block : <span><span class="xref-unresolved">Tezos_client_008_PtEdo2Zk</span>.Protocol_client_context.#full <span class="arrow">&#45;&gt;</span></span> <span>?force:bool <span class="arrow">&#45;&gt;</span></span>
<span>?operations:<span><a href="../../../tezos-protocol-008-PtEdo2Zk/Tezos_raw_protocol_008_PtEdo2Zk/Alpha_context/Operation/index.html#type-packed">Tezos_protocol_008_PtEdo2Zk.Protocol.Alpha_context.Operation.packed</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span>?best_effort:bool <span class="arrow">&#45;&gt;</span></span> <span>?sort:bool <span class="arrow">&#45;&gt;</span></span> <span>?minimal_fees:<a href="../../../tezos-protocol-008-PtEdo2Zk/Tezos_raw_protocol_008_PtEdo2Zk/Alpha_context/Tez/index.html#type-t">Tezos_protocol_008_PtEdo2Zk.Protocol.Alpha_context.Tez.t</a> <span class="arrow">&#45;&gt;</span></span>
<span>?minimal_nanotez_per_gas_unit:<span class="xref-unresolved">Q</span>.t <span class="arrow">&#45;&gt;</span></span> <span>?minimal_nanotez_per_byte:<span class="xref-unresolved">Q</span>.t <span class="arrow">&#45;&gt;</span></span> <span>?timestamp:<a href="../../../tezos-base/Tezos_base/Time/Protocol/index.html#type-t">Tezos_base.Time.Protocol.t</a> <span class="arrow">&#45;&gt;</span></span>
<span>?mempool:string <span class="arrow">&#45;&gt;</span></span> <span>?context_path:string <span class="arrow">&#45;&gt;</span></span> <span>?seed_nonce_hash:<a href="../../../tezos-protocol-008-PtEdo2Zk/Tezos_raw_protocol_008_PtEdo2Zk/Nonce_hash/index.html#type-t">Tezos_protocol_008_PtEdo2Zk.Protocol.Nonce_hash.t</a> <span class="arrow">&#45;&gt;</span></span> <span>chain:<a href="../../../tezos-shell-services/Tezos_shell_services/Chain_services/index.html#type-chain">Tezos_shell_services.Chain_services.chain</a> <span class="arrow">&#45;&gt;</span></span>
<span>priority:<span>[ <span>`Set of int</span> <span><span>| `Auto</span> of <a href="../../../tezos-protocol-008-PtEdo2Zk/Tezos_raw_protocol_008_PtEdo2Zk/Alpha_context/index.html#type-public_key_hash">Tezos_protocol_008_PtEdo2Zk.Protocol.Alpha_context.public_key_hash</a> * <span>int option</span></span> ]</span> <span class="arrow">&#45;&gt;</span></span> <span>delegate_pkh:<a href="../../../tezos-crypto/Tezos_crypto/Signature/Public_key_hash/index.html#type-t">Tezos_crypto.Signature.Public_key_hash.t</a> <span class="arrow">&#45;&gt;</span></span>
<span>delegate_sk:<a href="../../../tezos-client-base/Tezos_client_base/Client_keys/index.html#type-sk_uri">Tezos_client_base.Client_keys.sk_uri</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../tezos-shell-services/Tezos_shell_services/Block_services/index.html#type-block">Tezos_shell_services.Block_services.block</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<a href="../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a>, <span><a href="../../../tezos-error-monad/Tezos_error_monad/TzCore/index.html#type-error">Tezos_error_monad.TzCore.error</a> list</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>forge_block cctxt ?fee_threshold ?force ?operations ?best_effort
    ?sort ?timestamp ?max_priority ?priority ~seed_nonce ~src_sk
    pk_hash parent_blk</code> injects a block in the node. In addition of inject_block, it will:</p><p>* Operations: If <code>?operations</code> is <code>None</code>, it will get pending operations and add them to the block. Otherwise, provided operations will be used. In both cases, they will be validated.</p><p>* Baking priority: If <code>`Auto</code> is used, it will be computed from the public key hash of the specified contract, optionally capped to a maximum value, and optionally restricting for free baking slot.</p><p>* Timestamp: If <code>?timestamp</code> is set, and is compatible with the computed baking priority, it will be used. Otherwise, it will be set at the best baking priority.</p><p>* Fee Threshold: If <code>?fee_threshold</code> is given, operations with fees lower than it are not added to the block.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span><span class="xref-unresolved">Tezos_client_008_PtEdo2Zk</span>.Protocol_client_context.#full <span class="arrow">&#45;&gt;</span></span> <span>user_activated_upgrades:<a href="../../../tezos-base/Tezos_base/User_activated/index.html#type-upgrades">Tezos_base.User_activated.upgrades</a> <span class="arrow">&#45;&gt;</span></span>
<span>?minimal_fees:<a href="../../../tezos-protocol-008-PtEdo2Zk/Tezos_raw_protocol_008_PtEdo2Zk/Alpha_context/Tez/index.html#type-t">Tezos_protocol_008_PtEdo2Zk.Protocol.Alpha_context.Tez.t</a> <span class="arrow">&#45;&gt;</span></span> <span>?minimal_nanotez_per_gas_unit:<span class="xref-unresolved">Q</span>.t <span class="arrow">&#45;&gt;</span></span>
<span>?minimal_nanotez_per_byte:<span class="xref-unresolved">Q</span>.t <span class="arrow">&#45;&gt;</span></span> <span>?max_priority:int <span class="arrow">&#45;&gt;</span></span> <span>chain:<a href="../../../tezos-shell-services/Tezos_shell_services/Chain_services/index.html#type-chain">Tezos_shell_services.Chain_services.chain</a> <span class="arrow">&#45;&gt;</span></span> <span>context_path:string <span class="arrow">&#45;&gt;</span></span>
<span><span><a href="../../../tezos-protocol-008-PtEdo2Zk/Tezos_raw_protocol_008_PtEdo2Zk/Alpha_context/index.html#type-public_key_hash">Tezos_protocol_008_PtEdo2Zk.Protocol.Alpha_context.public_key_hash</a> list</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span><span>(<a href="../Client_baking_blocks/index.html#type-block_info">Client_baking_blocks.block_info</a>, <span><a href="../../../tezos-error-monad/Tezos_error_monad/TzCore/index.html#type-error">Tezos_error_monad.TzCore.error</a> list</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt_stream</span>.t</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(unit, <span><a href="../../../tezos-error-monad/Tezos_error_monad/TzCore/index.html#type-error">Tezos_error_monad.TzCore.error</a> list</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div></div></body></html>