<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Compiler (tezos-protocol-compiler.Tezos_protocol_compiler.Compiler)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">tezos-protocol-compiler</a> &#x00BB; <a href="../index.html">Tezos_protocol_compiler</a> &#x00BB; Compiler</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_protocol_compiler.Compiler</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec value" id="val-warnings" class="anchored"><a href="#val-warnings" class="anchor"></a><code><span><span class="keyword">val</span> warnings : string</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-warn_error" class="anchored"><a href="#val-warn_error" class="anchor"></a><code><span><span class="keyword">val</span> warn_error : string</span></code></div></div><p>Override the default 'Env.Persistent_signature.load' with a lookup in locally defined hashtable.</p><div class="odoc-spec"><div class="spec value" id="val-preloaded_cmis" class="anchored"><a href="#val-preloaded_cmis" class="anchor"></a><code><span><span class="keyword">val</span> preloaded_cmis : <span><span class="xref-unresolved">Persistent_env</span>.Persistent_signature.t <span class="xref-unresolved">Tezos_base__TzPervasives.String.Hashtbl.t</span></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-load_cmi_from_file" class="anchored"><a href="#val-load_cmi_from_file" class="anchor"></a><code><span><span class="keyword">val</span> load_cmi_from_file : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-load_embedded_cmi" class="anchored"><a href="#val-load_embedded_cmi" class="anchor"></a><code><span><span class="keyword">val</span> load_embedded_cmi : <span><span>(string * string)</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-load_embedded_cmis" class="anchored"><a href="#val-load_embedded_cmis" class="anchor"></a><code><span><span class="keyword">val</span> load_embedded_cmis : <span><span><span>(string * string)</span> list</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><p>Compilation environment.</p><p><code>tezos_protocol_env</code> defines the list of <code>cmi</code> available while compiling the protocol version. The <code>cmi</code> are packed into the <code>tezos-node</code> binary by using <code>ocp-ocamlres</code>, see the Makefile.</p><p><code>register_env</code> defines a complementary list of <code>cmi</code> available while compiling the generated <code>register.ml</code> file (that register the protocol first-class module into the <code>Updater.versions</code> hashtable).</p><div class="odoc-spec"><div class="spec value" id="val-tezos_protocol_env" class="anchored"><a href="#val-tezos_protocol_env" class="anchor"></a><code><span><span class="keyword">val</span> tezos_protocol_env : <span><span>(string * string)</span> list</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-register_env" class="anchored"><a href="#val-register_env" class="anchor"></a><code><span><span class="keyword">val</span> register_env : <span><span>(string * string)</span> list</span></span></code></div></div><p>Helpers</p><div class="odoc-spec"><div class="spec value" id="val-create_file" class="anchored"><a href="#val-create_file" class="anchor"></a><code><span><span class="keyword">val</span> create_file : <span>?perm:<span class="xref-unresolved">Unix</span>.file_perm <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-safe_unlink" class="anchored"><a href="#val-safe_unlink" class="anchor"></a><code><span><span class="keyword">val</span> safe_unlink : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-unlink_cmi" class="anchored"><a href="#val-unlink_cmi" class="anchor"></a><code><span><span class="keyword">val</span> unlink_cmi : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>(string * <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-unlink_object" class="anchored"><a href="#val-unlink_object" class="anchor"></a><code><span><span class="keyword">val</span> unlink_object : <span>string <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-debug_flag" class="anchored"><a href="#val-debug_flag" class="anchor"></a><code><span><span class="keyword">val</span> debug_flag : <span>bool <span class="xref-unresolved">Stdlib</span>.ref</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-debug" class="anchored"><a href="#val-debug" class="anchor"></a><code><span><span class="keyword">val</span> debug : <span><span><span>(<span class="type-var">'a</span>, <span class="xref-unresolved">Stdlib</span>.Format.formatter, unit)</span> <span class="xref-unresolved">Stdlib</span>.format</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-mktemp_dir" class="anchored"><a href="#val-mktemp_dir" class="anchor"></a><code><span><span class="keyword">val</span> mktemp_dir : <span>unit <span class="arrow">&#45;&gt;</span></span> string</span></code></div></div><p>Main</p><div class="odoc-spec"><div class="spec type" id="type-driver" class="anchored"><a href="#type-driver" class="anchor"></a><code><span><span class="keyword">type</span> driver</span><span> = </span><span>{</span></code><table><tr id="type-driver.compile_ml" class="anchored"><td class="def record field"><a href="#type-driver.compile_ml" class="anchor"></a><code><span>compile_ml : <span>?for_pack:string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> string;</span></code></td></tr><tr id="type-driver.pack_objects" class="anchored"><td class="def record field"><a href="#type-driver.pack_objects" class="anchor"></a><code><span>pack_objects : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> string;</span></code></td></tr><tr id="type-driver.link_shared" class="anchored"><td class="def record field"><a href="#type-driver.link_shared" class="anchor"></a><code><span>link_shared : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> unit;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-main" class="anchored"><a href="#val-main" class="anchor"></a><code><span><span class="keyword">val</span> main : <span><a href="#type-driver">driver</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div></div></body></html>