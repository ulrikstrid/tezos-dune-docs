<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Make_es (tezos-lwt-result-stdlib.Traced_structs__Hashtbl.Make.Make_es)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../../index.html">tezos-lwt-result-stdlib</a> &#x00BB; <a href="../../index.html">Traced_structs__Hashtbl</a> &#x00BB; <a href="../index.html">Make</a> &#x00BB; Make_es</nav><h1>Module <code>Make.Make_es</code></h1></header><h3 class="heading">Parameters</h3><ul><li><code>H : Stdlib.Hashtbl.HashedType</code></li></ul><h3 class="heading">Signature</h3><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../../../Bare_functor_outputs/Hashtbl/index.html#module-type-S_ES">Bare_functor_outputs.Hashtbl.S_ES</a></code></span></summary><dl><dt class="spec type" id="type-key"><a href="#type-key" class="anchor"></a><code><span class="keyword">type</span> key</code></dt><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> <span>('a, 'trace) t</span></code></dt></dl><dl><dt class="spec value" id="val-create"><a href="#val-create" class="anchor"></a><code><span class="keyword">val</span> create : int <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="index.html#type-t">t</a></span></code></dt><dt class="spec value" id="val-clear"><a href="#val-clear" class="anchor"></a><code><span class="keyword">val</span> clear : <span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>clear tbl</code> cancels and removes all the promises in <code>tbl</code>.</p></dd></dl><dl><dt class="spec value" id="val-reset"><a href="#val-reset" class="anchor"></a><code><span class="keyword">val</span> reset : <span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>reset tbl</code> cancels and removes all the promises in <code>tbl</code>, and resizes <code>tbl</code> to its initial size.</p></dd></dl><dl><dt class="spec value" id="val-find_or_make"><a href="#val-find_or_make" class="anchor"></a><code><span class="keyword">val</span> find_or_make : <span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <a href="index.html#type-key">key</a> <span>&#45;&gt;</span> <span>(unit <span>&#45;&gt;</span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> Stdlib.result</span> Lwt.t</span>)</span> <span>&#45;&gt;</span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> Stdlib.result</span> Lwt.t</span></code></dt><dd><p><code>find_or_make tbl k make</code> behaves differently depending on <code>k</code> being bound in <code>tbl</code>:</p><ul><li>if <code>k</code> is bound in <code>tbl</code> then <code>find_or_make tbl k make</code> returns the promise <code>p</code> that <code>k</code> is bound to. This <code>p</code> might be already fulfilled with <code>Ok _</code> or it might be pending. This <code>p</code> cannot be already fulfilled with <code>Error _</code> or already rejected. This is because <code>Error</code>/rejected promises are removed from the table automatically. Note however that if this <code>p</code> is pending, <code>p</code> might become fulfilled with <code>Error _</code> or become rejected.</li><li>if <code>k</code> is not bound in <code>tbl</code> then <code>make ()</code> is called and the returned promise <code>p</code> is bound to <code>k</code> in <code>tbl</code>. Then <code>p</code> is returned. When <code>p</code> is resolved, it may be removed automatically from <code>tbl</code> as described above.</li></ul></dd></dl><dl><dt class="spec value" id="val-remove"><a href="#val-remove" class="anchor"></a><code><span class="keyword">val</span> remove : <span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <a href="index.html#type-key">key</a> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>remove tbl k</code> cancels the promise bound to <code>k</code> in <code>tbl</code> and removes it. If <code>k</code> is not bound in <code>tbl</code> it does nothing.</p></dd></dl><dl><dt class="spec value" id="val-find"><a href="#val-find" class="anchor"></a><code><span class="keyword">val</span> find : <span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <a href="index.html#type-key">key</a> <span>&#45;&gt;</span> <span><span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> Stdlib.result</span> Lwt.t</span> option</span></code></dt><dt class="spec value" id="val-mem"><a href="#val-mem" class="anchor"></a><code><span class="keyword">val</span> mem : <span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <a href="index.html#type-key">key</a> <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-iter_with_waiting_es"><a href="#val-iter_with_waiting_es" class="anchor"></a><code><span class="keyword">val</span> iter_with_waiting_es : <span>(<a href="index.html#type-key">key</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span><span>(unit, <span class="type-var">'trace</span>)</span> Stdlib.result</span> Lwt.t</span>)</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span><span>(unit, <span class="type-var">'trace</span>)</span> Stdlib.result</span> Lwt.t</span></code></dt><dd><p><code>iter_with_waiting_es f tbl</code> iterates <code>f</code> over the bindings in <code>tbl</code>.</p><p>Specifically, for each binding <code>(k, p)</code> it waits for <code>p</code> to be fulfilled with <code>Ok v</code> and calls <code>f k v</code>. If <code>p</code> fulfills with <code>Error _</code> or is rejected, then no call to <code>f</code> is made for this binding. Note however that an <code>Error</code>/rejection in one promise returned by <code>f</code> interrupts the iteration.</p><p>It processes bindings one after the other: it waits for both the bound promise to resolve and then the call promise to resolve before continuing to the next binding.</p></dd></dl><dl><dt class="spec value" id="val-iter_with_waiting_ep"><a href="#val-iter_with_waiting_ep" class="anchor"></a><code><span class="keyword">val</span> iter_with_waiting_ep : <span>(<a href="index.html#type-key">key</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span><span>(unit, <span class="type-var">'error</span>)</span> Stdlib.result</span> Lwt.t</span>)</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'error</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span><span>(unit, <span><span class="type-var">'error</span> list</span>)</span> Stdlib.result</span> Lwt.t</span></code></dt><dd><p><code>iter_with_waiting_ep f tbl</code> iterates <code>f</code> over the bindings in <code>tbl</code>.</p><p>Specifically, for each binding <code>(k, p)</code> it waits for <code>p</code> to be fulfilled with <code>Ok v</code> and calls <code>f k v</code>. If <code>p</code> fulfills with <code>Error _</code> or is rejected, then no call is made for this binding.</p><p>Note however that if one (or more) of the promises returned by <code>f</code> ends in <code>Error</code>/rejection, the final result of this promise is an <code>Error</code>/rejection. Even so, it only resolves once all the promises have.</p><p>It processes all bindings concurrently: it concurrently waits for all the bound promises to resolve and calls <code>f</code> as they resolve.</p></dd></dl><dl><dt class="spec value" id="val-fold_with_waiting_es"><a href="#val-fold_with_waiting_es" class="anchor"></a><code><span class="keyword">val</span> fold_with_waiting_es : <span>(<a href="index.html#type-key">key</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span><span><span>(<span class="type-var">'b</span>, <span class="type-var">'trace</span>)</span> Stdlib.result</span> Lwt.t</span>)</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span><span><span>(<span class="type-var">'b</span>, <span class="type-var">'trace</span>)</span> Stdlib.result</span> Lwt.t</span></code></dt><dd><p><code>fold_with_waiting_es f tbl init</code> folds <code>init</code> with <code>f</code> over the bindings in <code>tbl</code>.</p><p>Specifically, for each binding <code>(k, p)</code> it waits for <code>p</code> to be fulfilled with <code>Ok v</code> and determines the next accumulator by calling <code>f k v acc</code>. If <code>p</code> fulfills with <code>Error _</code> or is rejected, then no call is made for this binding.</p><p>It processes bindings one after the other.</p></dd></dl><dl><dt class="spec value" id="val-fold_keys"><a href="#val-fold_keys" class="anchor"></a><code><span class="keyword">val</span> fold_keys : <span>(<a href="index.html#type-key">key</a> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dt class="spec value" id="val-fold_promises"><a href="#val-fold_promises" class="anchor"></a><code><span class="keyword">val</span> fold_promises : <span>(<a href="index.html#type-key">key</a> <span>&#45;&gt;</span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> Stdlib.result</span> Lwt.t</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dd><p><code>fold_promises f tbl init</code> folds over the table, passing the raw promises to <code>f</code>. This means that <code>f</code> can observe <code>Error</code>/rejections.</p><p>This can be used to, e.g., count the number of resolved/unresolved promises.</p></dd></dl><dl><dt class="spec value" id="val-fold_resolved"><a href="#val-fold_resolved" class="anchor"></a><code><span class="keyword">val</span> fold_resolved : <span>(<a href="index.html#type-key">key</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span class="type-var">'b</span> <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dd><p><code>fold_resolved f tbl init</code> folds over the already resolved promises of <code>tbl</code>. More specifically, it folds over the <code>v</code> for all the promises fulfilled with <code>Ok v</code> that are bound in <code>tbl</code>.</p></dd></dl><dl><dt class="spec value" id="val-length"><a href="#val-length" class="anchor"></a><code><span class="keyword">val</span> length : <span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> int</code></dt><dt class="spec value" id="val-stats"><a href="#val-stats" class="anchor"></a><code><span class="keyword">val</span> stats : <span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> Stdlib.Hashtbl.statistics</code></dt></dl></details></div></div></div><dl><dt class="spec type" id="type-trace"><a href="#type-trace" class="anchor"></a><code><span class="keyword">type</span> <span>'error trace</span></code></dt><dd><p><code>'error trace</code> is intended to be substituted by a type provided by a <code>Trace</code> module (<code>with type 'error trace := 'error Trace.trace</code>)</p></dd></dl><dl><dt class="spec value" id="val-iter_with_waiting_ep"><a href="#val-iter_with_waiting_ep" class="anchor"></a><code><span class="keyword">val</span> iter_with_waiting_ep : <span>(<a href="index.html#type-key">key</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span><span><span>(unit, <span><span class="type-var">'error</span> <a href="index.html#type-trace">trace</a></span>)</span> Stdlib.result</span> Lwt.t</span>)</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span>, <span><span class="type-var">'error</span> <a href="index.html#type-trace">trace</a></span>)</span> <a href="index.html#type-t">t</a></span> <span>&#45;&gt;</span> <span><span><span>(unit, <span><span class="type-var">'error</span> <a href="index.html#type-trace">trace</a></span>)</span> Stdlib.result</span> Lwt.t</span></code></dt></dl></div></body></html>