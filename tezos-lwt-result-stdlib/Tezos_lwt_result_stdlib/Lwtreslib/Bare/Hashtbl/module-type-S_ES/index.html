<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>S_ES (tezos-lwt-result-stdlib.Tezos_lwt_result_stdlib.Lwtreslib.Bare.Hashtbl.S_ES)</title><link rel="stylesheet" href="../../../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../../../../index.html">tezos-lwt-result-stdlib</a> &#x00BB; <a href="../../../../index.html">Tezos_lwt_result_stdlib</a> &#x00BB; <a href="../../../index.html">Lwtreslib</a> &#x00BB; <a href="../../index.html">Bare</a> &#x00BB; <a href="../index.html">Hashtbl</a> &#x00BB; S_ES</nav><header class="odoc-preamble"><h1>Module type <code><span>Hashtbl.S_ES</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-key" class="anchored"><a href="#type-key" class="anchor"></a><code><span><span class="keyword">type</span> key</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>('a, 'trace) t</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-create" class="anchored"><a href="#val-create" class="anchor"></a><code><span><span class="keyword">val</span> create : <span>int <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="#type-t">t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-clear" class="anchored"><a href="#val-clear" class="anchor"></a><code><span><span class="keyword">val</span> clear : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>clear tbl</code> cancels and removes all the promises in <code>tbl</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-reset" class="anchored"><a href="#val-reset" class="anchor"></a><code><span><span class="keyword">val</span> reset : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>reset tbl</code> cancels and removes all the promises in <code>tbl</code>, and resizes <code>tbl</code> to its initial size.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-find_or_make" class="anchored"><a href="#val-find_or_make" class="anchor"></a><code><span><span class="keyword">val</span> find_or_make : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-key">key</a> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span>unit <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>find_or_make tbl k make</code> behaves differently depending on <code>k</code> being bound in <code>tbl</code>:</p><ul><li>if <code>k</code> is bound in <code>tbl</code> then <code>find_or_make tbl k make</code> returns the promise <code>p</code> that <code>k</code> is bound to. This <code>p</code> might be already fulfilled with <code>Ok _</code> or it might be pending. This <code>p</code> cannot be already fulfilled with <code>Error _</code> or already rejected. This is because <code>Error</code>/rejected promises are removed from the table automatically. Note however that if this <code>p</code> is pending, <code>p</code> might become fulfilled with <code>Error _</code> or become rejected.</li><li>if <code>k</code> is not bound in <code>tbl</code> then <code>make ()</code> is called and the returned promise <code>p</code> is bound to <code>k</code> in <code>tbl</code>. Then <code>p</code> is returned. When <code>p</code> is resolved, it may be removed automatically from <code>tbl</code> as described above.</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-remove" class="anchored"><a href="#val-remove" class="anchor"></a><code><span><span class="keyword">val</span> remove : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-key">key</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>remove tbl k</code> cancels the promise bound to <code>k</code> in <code>tbl</code> and removes it. If <code>k</code> is not bound in <code>tbl</code> it does nothing.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-find" class="anchored"><a href="#val-find" class="anchor"></a><code><span><span class="keyword">val</span> find : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-key">key</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span> option</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-mem" class="anchored"><a href="#val-mem" class="anchor"></a><code><span><span class="keyword">val</span> mem : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-key">key</a> <span class="arrow">&#45;&gt;</span></span> bool</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-iter_with_waiting_es" class="anchored"><a href="#val-iter_with_waiting_es" class="anchor"></a><code><span><span class="keyword">val</span> iter_with_waiting_es : <span><span>(<span><a href="#type-key">key</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(unit, <span class="type-var">'trace</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(unit, <span class="type-var">'trace</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>iter_with_waiting_es f tbl</code> iterates <code>f</code> over the bindings in <code>tbl</code>.</p><p>Specifically, for each binding <code>(k, p)</code> it waits for <code>p</code> to be fulfilled with <code>Ok v</code> and calls <code>f k v</code>. If <code>p</code> fulfills with <code>Error _</code> or is rejected, then no call to <code>f</code> is made for this binding. Note however that an <code>Error</code>/rejection in one promise returned by <code>f</code> interrupts the iteration.</p><p>It processes bindings one after the other: it waits for both the bound promise to resolve and then the call promise to resolve before continuing to the next binding.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-iter_with_waiting_ep" class="anchored"><a href="#val-iter_with_waiting_ep" class="anchor"></a><code><span><span class="keyword">val</span> iter_with_waiting_ep : <span><span>(<span><a href="#type-key">key</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(unit, <span class="type-var">'error</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'error</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(unit, <span><span class="type-var">'error</span> list</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>iter_with_waiting_ep f tbl</code> iterates <code>f</code> over the bindings in <code>tbl</code>.</p><p>Specifically, for each binding <code>(k, p)</code> it waits for <code>p</code> to be fulfilled with <code>Ok v</code> and calls <code>f k v</code>. If <code>p</code> fulfills with <code>Error _</code> or is rejected, then no call is made for this binding.</p><p>Note however that if one (or more) of the promises returned by <code>f</code> ends in <code>Error</code>/rejection, the final result of this promise is an <code>Error</code>/rejection. Even so, it only resolves once all the promises have.</p><p>It processes all bindings concurrently: it concurrently waits for all the bound promises to resolve and calls <code>f</code> as they resolve.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-fold_with_waiting_es" class="anchored"><a href="#val-fold_with_waiting_es" class="anchor"></a><code><span><span class="keyword">val</span> fold_with_waiting_es : <span><span>(<span><a href="#type-key">key</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'b</span>, <span class="type-var">'trace</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'b</span>, <span class="type-var">'trace</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>fold_with_waiting_es f tbl init</code> folds <code>init</code> with <code>f</code> over the bindings in <code>tbl</code>.</p><p>Specifically, for each binding <code>(k, p)</code> it waits for <code>p</code> to be fulfilled with <code>Ok v</code> and determines the next accumulator by calling <code>f k v acc</code>. If <code>p</code> fulfills with <code>Error _</code> or is rejected, then no call is made for this binding.</p><p>It processes bindings one after the other.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-fold_keys" class="anchored"><a href="#val-fold_keys" class="anchor"></a><code><span><span class="keyword">val</span> fold_keys : <span><span>(<span><a href="#type-key">key</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-fold_promises" class="anchored"><a href="#val-fold_promises" class="anchor"></a><code><span><span class="keyword">val</span> fold_promises : <span><span>(<span><a href="#type-key">key</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span></span></code></div><div class="spec-doc"><p><code>fold_promises f tbl init</code> folds over the table, passing the raw promises to <code>f</code>. This means that <code>f</code> can observe <code>Error</code>/rejections.</p><p>This can be used to, e.g., count the number of resolved/unresolved promises.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-fold_resolved" class="anchored"><a href="#val-fold_resolved" class="anchor"></a><code><span><span class="keyword">val</span> fold_resolved : <span><span>(<span><a href="#type-key">key</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span></span></code></div><div class="spec-doc"><p><code>fold_resolved f tbl init</code> folds over the already resolved promises of <code>tbl</code>. More specifically, it folds over the <code>v</code> for all the promises fulfilled with <code>Ok v</code> that are bound in <code>tbl</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-length" class="anchored"><a href="#val-length" class="anchor"></a><code><span><span class="keyword">val</span> length : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> int</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-stats" class="anchored"><a href="#val-stats" class="anchor"></a><code><span><span class="keyword">val</span> stats : <span><span><span>(<span class="type-var">'a</span>, <span class="type-var">'trace</span>)</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="xref-unresolved">Stdlib</span>.Hashtbl.statistics</span></code></div></div></div></body></html>