<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Micheline (tezos-micheline.Tezos_micheline.Micheline)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">tezos-micheline</a> &#x00BB; <a href="../index.html">Tezos_micheline</a> &#x00BB; Micheline</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_micheline.Micheline</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-annot" class="anchored"><a href="#type-annot" class="anchor"></a><code><span><span class="keyword">type</span> annot</span><span> = <span>string list</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-node" class="anchored"><a href="#type-node" class="anchor"></a><code><span><span class="keyword">type</span> <span>('l, 'p) node</span></span><span> = </span></code><table><tr id="type-node.Int" class="anchored"><td class="def variant constructor"><a href="#type-node.Int" class="anchor"></a><code><span>| </span><span><span class="constructor">Int</span> <span class="keyword">of</span> <span class="type-var">'l</span> * <span class="xref-unresolved">Z</span>.t</span></code></td></tr><tr id="type-node.String" class="anchored"><td class="def variant constructor"><a href="#type-node.String" class="anchor"></a><code><span>| </span><span><span class="constructor">String</span> <span class="keyword">of</span> <span class="type-var">'l</span> * string</span></code></td></tr><tr id="type-node.Bytes" class="anchored"><td class="def variant constructor"><a href="#type-node.Bytes" class="anchor"></a><code><span>| </span><span><span class="constructor">Bytes</span> <span class="keyword">of</span> <span class="type-var">'l</span> * <span class="xref-unresolved">Stdlib</span>.Bytes.t</span></code></td></tr><tr id="type-node.Prim" class="anchored"><td class="def variant constructor"><a href="#type-node.Prim" class="anchor"></a><code><span>| </span><span><span class="constructor">Prim</span> <span class="keyword">of</span> <span class="type-var">'l</span> * <span class="type-var">'p</span> * <span><span><span>(<span class="type-var">'l</span>, <span class="type-var">'p</span>)</span> <a href="#type-node">node</a></span> list</span> * <a href="#type-annot">annot</a></span></code></td></tr><tr id="type-node.Seq" class="anchored"><td class="def variant constructor"><a href="#type-node.Seq" class="anchor"></a><code><span>| </span><span><span class="constructor">Seq</span> <span class="keyword">of</span> <span class="type-var">'l</span> * <span><span><span>(<span class="type-var">'l</span>, <span class="type-var">'p</span>)</span> <a href="#type-node">node</a></span> list</span></span></code></td></tr></table></div><div class="spec-doc"><p>The abstract syntax tree of Micheline expressions. The first parameter is used to contain locations, but can also embed custom data. The second parameter is the type of primitive names.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-table_encoding" class="anchored"><a href="#val-table_encoding" class="anchor"></a><code><span><span class="keyword">val</span> table_encoding : <span>variant:string <span class="arrow">&#45;&gt;</span></span>
<span><span><span class="type-var">'l</span> <span class="xref-unresolved">Data_encoding</span>.encoding</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'p</span> <span class="xref-unresolved">Data_encoding</span>.encoding</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'l</span>, <span class="type-var">'p</span>)</span> <a href="#type-node">node</a></span> <span class="xref-unresolved">Data_encoding</span>.encoding</span></span></code></div><div class="spec-doc"><p>Encoding for expressions, as their <a href="#type-canonical"><code>canonical</code></a> encoding. Locations are stored in a side table. See <a href="#val-canonical_encoding"><code>canonical_encoding</code></a> for the <code>variant</code> parameter.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-erased_encoding" class="anchored"><a href="#val-erased_encoding" class="anchor"></a><code><span><span class="keyword">val</span> erased_encoding : <span>variant:string <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'l</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'p</span> <span class="xref-unresolved">Data_encoding</span>.encoding</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'l</span>, <span class="type-var">'p</span>)</span> <a href="#type-node">node</a></span> <span class="xref-unresolved">Data_encoding</span>.encoding</span></span></code></div><div class="spec-doc"><p>Encoding for expressions, as their <a href="#type-canonical"><code>canonical</code></a> encoding. Locations are erased when serialized, and restored to a provided default value when deserialized. See <a href="#val-canonical_encoding"><code>canonical_encoding</code></a> for the <code>variant</code> parameter.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-location" class="anchored"><a href="#val-location" class="anchor"></a><code><span><span class="keyword">val</span> location : <span><span><span>(<span class="type-var">'l</span>, <span class="type-var">'p</span>)</span> <a href="#type-node">node</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'l</span></span></code></div><div class="spec-doc"><p>Extract the location of the node.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-annotations" class="anchored"><a href="#val-annotations" class="anchor"></a><code><span><span class="keyword">val</span> annotations : <span><span><span>(<span class="type-var">'l</span>, <span class="type-var">'p</span>)</span> <a href="#type-node">node</a></span> <span class="arrow">&#45;&gt;</span></span> <span>string list</span></span></code></div><div class="spec-doc"><p>Extract the annotations of the node.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-canonical" class="anchored"><a href="#type-canonical" class="anchor"></a><code><span><span class="keyword">type</span> <span>'p canonical</span></span></code></div><div class="spec-doc"><p>Expression form using canonical integer numbering as locations. The root has number zero, and each node adds one in the order of infix traversal. To be used when locations are not important, or when one wants to attach properties to nodes in an expression without rewriting it (using an indirection table with canonical locations as keys).</p></div></div><div class="odoc-spec"><div class="spec type" id="type-canonical_location" class="anchored"><a href="#type-canonical_location" class="anchor"></a><code><span><span class="keyword">type</span> canonical_location</span><span> = int</span></code></div><div class="spec-doc"><p>Canonical integer locations that appear inside <a href="#type-canonical"><code>canonical</code></a> expressions.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-canonical_location_encoding" class="anchored"><a href="#val-canonical_location_encoding" class="anchor"></a><code><span><span class="keyword">val</span> canonical_location_encoding : <span><a href="#type-canonical_location">canonical_location</a> <span class="xref-unresolved">Data_encoding</span>.encoding</span></span></code></div><div class="spec-doc"><p>Encoding for canonical integer locations.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-canonical_encoding" class="anchored"><a href="#val-canonical_encoding" class="anchor"></a><code><span><span class="keyword">val</span> canonical_encoding : <span>variant:string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'l</span> <span class="xref-unresolved">Data_encoding</span>.encoding</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'l</span> <a href="#type-canonical">canonical</a></span> <span class="xref-unresolved">Data_encoding</span>.encoding</span></span></code></div><div class="spec-doc"><p>Encoding for expressions in canonical form. The first parameter is a name used to produce named definitions in the schemas. Make sure to use different names if two expression variants with different primitive encodings are used in the same schema.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-canonical_encoding_v0" class="anchored"><a href="#val-canonical_encoding_v0" class="anchor"></a><code><span><span class="keyword">val</span> canonical_encoding_v0 : <span>variant:string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'l</span> <span class="xref-unresolved">Data_encoding</span>.encoding</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'l</span> <a href="#type-canonical">canonical</a></span> <span class="xref-unresolved">Data_encoding</span>.encoding</span></span></code></div><div class="spec-doc"><p>Old version of <a href="#val-canonical_encoding"><code>canonical_encoding</code></a> for backward compatibility. Do not use in new code.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-canonical_encoding_v1" class="anchored"><a href="#val-canonical_encoding_v1" class="anchor"></a><code><span><span class="keyword">val</span> canonical_encoding_v1 : <span>variant:string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'l</span> <span class="xref-unresolved">Data_encoding</span>.encoding</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'l</span> <a href="#type-canonical">canonical</a></span> <span class="xref-unresolved">Data_encoding</span>.encoding</span></span></code></div><div class="spec-doc"><p>Alias for <a href="#val-canonical_encoding"><code>canonical_encoding</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-strip_locations" class="anchored"><a href="#val-strip_locations" class="anchor"></a><code><span><span class="keyword">val</span> strip_locations : <span><span><span>(<span class="type-var">_</span>, <span class="type-var">'p</span>)</span> <a href="#type-node">node</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'p</span> <a href="#type-canonical">canonical</a></span></span></code></div><div class="spec-doc"><p>Compute the canonical form of an expression. Drops the concrete locations completely.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-root" class="anchored"><a href="#val-root" class="anchor"></a><code><span><span class="keyword">val</span> root : <span><span><span class="type-var">'p</span> <a href="#type-canonical">canonical</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<a href="#type-canonical_location">canonical_location</a>, <span class="type-var">'p</span>)</span> <a href="#type-node">node</a></span></span></code></div><div class="spec-doc"><p>Give the root node of an expression in canonical form.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-extract_locations" class="anchored"><a href="#val-extract_locations" class="anchor"></a><code><span><span class="keyword">val</span> extract_locations : <span><span><span>(<span class="type-var">'l</span>, <span class="type-var">'p</span>)</span> <a href="#type-node">node</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'p</span> <a href="#type-canonical">canonical</a></span> * <span><span>(<a href="#type-canonical_location">canonical_location</a> * <span class="type-var">'l</span>)</span> list</span></span></code></div><div class="spec-doc"><p>Compute the canonical form of an expression. Saves the concrete locations in an association list.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-inject_locations" class="anchored"><a href="#val-inject_locations" class="anchor"></a><code><span><span class="keyword">val</span> inject_locations : <span><span>(<span><a href="#type-canonical_location">canonical_location</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'l</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'p</span> <a href="#type-canonical">canonical</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'l</span>, <span class="type-var">'p</span>)</span> <a href="#type-node">node</a></span></span></code></div><div class="spec-doc"><p>Transforms an expression in canonical form into a polymorphic one. Takes a mapping function to inject the concrete locations.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-map" class="anchored"><a href="#val-map" class="anchor"></a><code><span><span class="keyword">val</span> map : <span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-canonical">canonical</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <a href="#type-canonical">canonical</a></span></span></code></div><div class="spec-doc"><p>Copies the tree, updating its primitives.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-map_node" class="anchored"><a href="#val-map_node" class="anchor"></a><code><span><span class="keyword">val</span> map_node : <span><span>(<span><span class="type-var">'la</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'lb</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><span class="type-var">'pa</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'pb</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'la</span>, <span class="type-var">'pa</span>)</span> <a href="#type-node">node</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span class="type-var">'lb</span>, <span class="type-var">'pb</span>)</span> <a href="#type-node">node</a></span></span></code></div><div class="spec-doc"><p>Copies the tree, updating its primitives and locations.</p></div></div></div></body></html>