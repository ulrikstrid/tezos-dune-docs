<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Snapshots (tezos-store.Tezos_store.Snapshots)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc %%VERSION%%"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">tezos-store</a> &#x00BB; <a href="../index.html">Tezos_store</a> &#x00BB; Snapshots</nav><header class="odoc-preamble"><h1>Module <code><span>Tezos_store.Snapshots</span></code></h1><p>Snapshots for the store</p><p>Snapshots are canonical representations of the store and its associated context. Its main purposes it to save and load a current state with the minimal necessary amount of information. This snapshot may also be shared by third parties to facilitate the bootstrap process.</p><p>A snapshot of a block <code>B</code> is composed of:</p><ul><li>The metadata of the snapshot;</li><li>A single context containing every key that the block <code>B-1</code> needs (see below);</li><li>The set of blocks and their operations from the genesis block up to <code>B</code> -- it might contain less blocks if the snapshot is created from a store using a <code>Rolling</code> history mode of if it is created as a <code>Rolling</code> snapshot. Block's metadata are not exported ;</li><li>The set of necessary Tezos protocols.</li></ul><p>Exporting a snapshot will generate such a file (or a directory, if the snapshot is not compressed). Importing a snapshot will initialize a fresh store with the data contained in the snapshot. As snapshots may be shared between users, checks are made to ensure that no malicious data is loaded. For instance, we export the context of block <code>B-1</code> to make sure that the application of the block <code>B</code>, given its predecessor's context, is valid.</p><p>Depending on the history mode, a snapshot might contain less blocks. In full, all blocks are present and importing such a snapshot will populate the <code>Cemented_store</code> with every cycle up to the snapshot's target block. Meanwhile, in <code>Rolling</code>, only a few previous blocks will be exported (<code>max_op_ttl</code> from the target block), only populating a <a href="../Floating_block_store/index.html"><code>Floating_block_store</code></a>. Thus, the snapshot size greatly differs depending on the history mode used.</p><p>Snapshots may be created concurrently with a running node. It might impact the node for a few seconds to retrieve the necessary consistent information to producethe snapshot.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type extension"><code><span><span class="keyword">type</span> <span class="xref-unresolved">Tezos_base__TzPervasives.error</span> += </span></code><table><tr id="extension-Incompatible_history_mode" class="anchored"><td class="def extension"><a href="#extension-Incompatible_history_mode" class="anchor"></a><code><span>| </span><span><span class="extension">Incompatible_history_mode</span> <span class="keyword">of</span> </span><span>{</span></code><table><tr id="module-Snapshots.requested" class="anchored"><td class="def record field"><a href="#module-Snapshots.requested" class="anchor"></a><code><span>requested : <a href="../../../tezos-shell-services/Tezos_shell_services/History_mode/index.html#type-t">Tezos_shell_services.History_mode.t</a>;</span></code></td></tr><tr id="module-Snapshots.stored" class="anchored"><td class="def record field"><a href="#module-Snapshots.stored" class="anchor"></a><code><span>stored : <a href="../../../tezos-shell-services/Tezos_shell_services/History_mode/index.html#type-t">Tezos_shell_services.History_mode.t</a>;</span></code></td></tr></table><code><span>}</span></code></td></tr><tr id="extension-Invalid_export_block" class="anchored"><td class="def extension"><a href="#extension-Invalid_export_block" class="anchor"></a><code><span>| </span><span><span class="extension">Invalid_export_block</span> <span class="keyword">of</span> </span><span>{</span></code><table><tr id="module-Snapshots.block" class="anchored"><td class="def record field"><a href="#module-Snapshots.block" class="anchor"></a><code><span>block : <span><a href="../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> option</span>;</span></code></td></tr><tr id="module-Snapshots.reason" class="anchored"><td class="def record field"><a href="#module-Snapshots.reason" class="anchor"></a><code><span>reason : <span>[ `Pruned <span>| `Pruned_pred</span> <span>| `Unknown</span> <span>| `Unknown_ancestor</span> <span>| `Caboose</span> <span>| `Genesis</span> <span>| `Not_enough_pred</span> ]</span>;</span></code></td></tr></table><code><span>}</span></code></td></tr><tr id="extension-Invalid_export_path" class="anchored"><td class="def extension"><a href="#extension-Invalid_export_path" class="anchor"></a><code><span>| </span><span><span class="extension">Invalid_export_path</span> <span class="keyword">of</span> string</span></code></td></tr><tr id="extension-Snapshot_file_not_found" class="anchored"><td class="def extension"><a href="#extension-Snapshot_file_not_found" class="anchor"></a><code><span>| </span><span><span class="extension">Snapshot_file_not_found</span> <span class="keyword">of</span> string</span></code></td></tr><tr id="extension-Inconsistent_protocol_hash" class="anchored"><td class="def extension"><a href="#extension-Inconsistent_protocol_hash" class="anchor"></a><code><span>| </span><span><span class="extension">Inconsistent_protocol_hash</span> <span class="keyword">of</span> </span><span>{</span></code><table><tr id="module-Snapshots.expected" class="anchored"><td class="def record field"><a href="#module-Snapshots.expected" class="anchor"></a><code><span>expected : <a href="../../../tezos-crypto/Tezos_crypto/Protocol_hash/index.html#type-t">Tezos_crypto.Protocol_hash.t</a>;</span></code></td></tr><tr id="module-Snapshots.got" class="anchored"><td class="def record field"><a href="#module-Snapshots.got" class="anchor"></a><code><span>got : <a href="../../../tezos-crypto/Tezos_crypto/Protocol_hash/index.html#type-t">Tezos_crypto.Protocol_hash.t</a>;</span></code></td></tr></table><code><span>}</span></code></td></tr><tr id="extension-Inconsistent_context_hash" class="anchored"><td class="def extension"><a href="#extension-Inconsistent_context_hash" class="anchor"></a><code><span>| </span><span><span class="extension">Inconsistent_context_hash</span> <span class="keyword">of</span> </span><span>{</span></code><table><tr id="module-Snapshots.expected" class="anchored"><td class="def record field"><a href="#module-Snapshots.expected" class="anchor"></a><code><span>expected : <a href="../../../tezos-crypto/Tezos_crypto/Context_hash/index.html#type-t">Tezos_crypto.Context_hash.t</a>;</span></code></td></tr><tr id="module-Snapshots.got" class="anchored"><td class="def record field"><a href="#module-Snapshots.got" class="anchor"></a><code><span>got : <a href="../../../tezos-crypto/Tezos_crypto/Context_hash/index.html#type-t">Tezos_crypto.Context_hash.t</a>;</span></code></td></tr></table><code><span>}</span></code></td></tr><tr id="extension-Inconsistent_context" class="anchored"><td class="def extension"><a href="#extension-Inconsistent_context" class="anchor"></a><code><span>| </span><span><span class="extension">Inconsistent_context</span> <span class="keyword">of</span> <a href="../../../tezos-crypto/Tezos_crypto/Context_hash/index.html#type-t">Tezos_crypto.Context_hash.t</a></span></code></td></tr><tr id="extension-Cannot_decode_protocol" class="anchored"><td class="def extension"><a href="#extension-Cannot_decode_protocol" class="anchor"></a><code><span>| </span><span><span class="extension">Cannot_decode_protocol</span> <span class="keyword">of</span> <a href="../../../tezos-crypto/Tezos_crypto/Protocol_hash/index.html#type-t">Tezos_crypto.Protocol_hash.t</a></span></code></td></tr><tr id="extension-Cannot_write_metadata" class="anchored"><td class="def extension"><a href="#extension-Cannot_write_metadata" class="anchor"></a><code><span>| </span><span><span class="extension">Cannot_write_metadata</span> <span class="keyword">of</span> string</span></code></td></tr><tr id="extension-Cannot_read" class="anchored"><td class="def extension"><a href="#extension-Cannot_read" class="anchor"></a><code><span>| </span><span><span class="extension">Cannot_read</span> <span class="keyword">of</span> </span><span>{</span></code><table><tr id="module-Snapshots.kind" class="anchored"><td class="def record field"><a href="#module-Snapshots.kind" class="anchor"></a><code><span>kind : <span>[ `Metadata <span>| `Block_data</span> <span>| `Context</span> <span>| `Protocol_table</span> <span>| `Protocol</span> <span>| `Cemented_cycle</span> ]</span>;</span></code></td></tr><tr id="module-Snapshots.path" class="anchored"><td class="def record field"><a href="#module-Snapshots.path" class="anchor"></a><code><span>path : string;</span></code></td></tr></table><code><span>}</span></code></td></tr><tr id="extension-Inconsistent_floating_store" class="anchored"><td class="def extension"><a href="#extension-Inconsistent_floating_store" class="anchor"></a><code><span>| </span><span><span class="extension">Inconsistent_floating_store</span> <span class="keyword">of</span> <a href="../Store_types/index.html#type-block_descriptor">Store_types.block_descriptor</a> * <a href="../Store_types/index.html#type-block_descriptor">Store_types.block_descriptor</a></span></code></td></tr><tr id="extension-Missing_target_block" class="anchored"><td class="def extension"><a href="#extension-Missing_target_block" class="anchor"></a><code><span>| </span><span><span class="extension">Missing_target_block</span> <span class="keyword">of</span> <a href="../Store_types/index.html#type-block_descriptor">Store_types.block_descriptor</a></span></code></td></tr><tr id="extension-Cannot_read_floating_store" class="anchored"><td class="def extension"><a href="#extension-Cannot_read_floating_store" class="anchor"></a><code><span>| </span><span><span class="extension">Cannot_read_floating_store</span> <span class="keyword">of</span> string</span></code></td></tr><tr id="extension-Cannot_retrieve_block_interval" class="anchored"><td class="def extension"><a href="#extension-Cannot_retrieve_block_interval" class="anchor"></a><code><span>| </span><span><span class="extension">Cannot_retrieve_block_interval</span></span></code></td></tr><tr id="extension-Invalid_cemented_file" class="anchored"><td class="def extension"><a href="#extension-Invalid_cemented_file" class="anchor"></a><code><span>| </span><span><span class="extension">Invalid_cemented_file</span> <span class="keyword">of</span> string</span></code></td></tr><tr id="extension-Missing_cemented_file" class="anchored"><td class="def extension"><a href="#extension-Missing_cemented_file" class="anchor"></a><code><span>| </span><span><span class="extension">Missing_cemented_file</span> <span class="keyword">of</span> string</span></code></td></tr><tr id="extension-Corrupted_floating_store" class="anchored"><td class="def extension"><a href="#extension-Corrupted_floating_store" class="anchor"></a><code><span>| </span><span><span class="extension">Corrupted_floating_store</span></span></code></td></tr><tr id="extension-Invalid_protocol_file" class="anchored"><td class="def extension"><a href="#extension-Invalid_protocol_file" class="anchor"></a><code><span>| </span><span><span class="extension">Invalid_protocol_file</span> <span class="keyword">of</span> string</span></code></td></tr><tr id="extension-Target_block_validation_failed" class="anchored"><td class="def extension"><a href="#extension-Target_block_validation_failed" class="anchor"></a><code><span>| </span><span><span class="extension">Target_block_validation_failed</span> <span class="keyword">of</span> <a href="../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> * string</span></code></td></tr><tr id="extension-Directory_already_exists" class="anchored"><td class="def extension"><a href="#extension-Directory_already_exists" class="anchor"></a><code><span>| </span><span><span class="extension">Directory_already_exists</span> <span class="keyword">of</span> string</span></code></td></tr><tr id="extension-Empty_floating_store" class="anchored"><td class="def extension"><a href="#extension-Empty_floating_store" class="anchor"></a><code><span>| </span><span><span class="extension">Empty_floating_store</span></span></code></td></tr><tr id="extension-Cannot_create_tmp_export_directory" class="anchored"><td class="def extension"><a href="#extension-Cannot_create_tmp_export_directory" class="anchor"></a><code><span>| </span><span><span class="extension">Cannot_create_tmp_export_directory</span> <span class="keyword">of</span> string</span></code></td></tr><tr id="extension-Inconsistent_chain_import" class="anchored"><td class="def extension"><a href="#extension-Inconsistent_chain_import" class="anchor"></a><code><span>| </span><span><span class="extension">Inconsistent_chain_import</span> <span class="keyword">of</span> </span><span>{</span></code><table><tr id="module-Snapshots.expected" class="anchored"><td class="def record field"><a href="#module-Snapshots.expected" class="anchor"></a><code><span>expected : <a href="../../../tezos-base/Tezos_base/Distributed_db_version/Name/index.html#type-t">Tezos_base.Distributed_db_version.Name.t</a>;</span></code></td></tr><tr id="module-Snapshots.got" class="anchored"><td class="def record field"><a href="#module-Snapshots.got" class="anchor"></a><code><span>got : <a href="../../../tezos-base/Tezos_base/Distributed_db_version/Name/index.html#type-t">Tezos_base.Distributed_db_version.Name.t</a>;</span></code></td></tr></table><code><span>}</span></code></td></tr><tr id="extension-Inconsistent_imported_block" class="anchored"><td class="def extension"><a href="#extension-Inconsistent_imported_block" class="anchor"></a><code><span>| </span><span><span class="extension">Inconsistent_imported_block</span> <span class="keyword">of</span> <a href="../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> * <a href="../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a></span></code></td></tr><tr id="extension-Inconsistent_snapshot_file" class="anchored"><td class="def extension"><a href="#extension-Inconsistent_snapshot_file" class="anchor"></a><code><span>| </span><span><span class="extension">Inconsistent_snapshot_file</span> <span class="keyword">of</span> string</span></code></td></tr></table></div></div><div class="odoc-spec"><div class="spec value" id="val-current_version" class="anchored"><a href="#val-current_version" class="anchor"></a><code><span><span class="keyword">val</span> current_version : int</span></code></div><div class="spec-doc"><p>Current version of snapshots</p></div></div><div class="odoc-spec"><div class="spec type" id="type-metadata" class="anchored"><a href="#type-metadata" class="anchor"></a><code><span><span class="keyword">type</span> metadata</span></code></div><div class="spec-doc"><p>The type of the snapshot <code>metadata</code>.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-snapshot_metadata" class="anchored"><a href="#type-snapshot_metadata" class="anchor"></a><code><span><span class="keyword">type</span> snapshot_metadata</span><span> = </span></code><table><tr id="type-snapshot_metadata.Current_metadata" class="anchored"><td class="def variant constructor"><a href="#type-snapshot_metadata.Current_metadata" class="anchor"></a><code><span>| </span><span><span class="constructor">Current_metadata</span> <span class="keyword">of</span> <a href="#type-metadata">metadata</a></span></code></td></tr><tr id="type-snapshot_metadata.Legacy_metadata" class="anchored"><td class="def variant constructor"><a href="#type-snapshot_metadata.Legacy_metadata" class="anchor"></a><code><span>| </span><span><span class="constructor">Legacy_metadata</span> <span class="keyword">of</span> </span><span>{</span></code><table><tr id="type-snapshot_metadata.version" class="anchored"><td class="def record field"><a href="#type-snapshot_metadata.version" class="anchor"></a><code><span>version : string;</span></code></td></tr><tr id="type-snapshot_metadata.legacy_history_mode" class="anchored"><td class="def record field"><a href="#type-snapshot_metadata.legacy_history_mode" class="anchor"></a><code><span>legacy_history_mode : <a href="../../../tezos-shell-services/Tezos_shell_services/History_mode/Legacy/index.html#type-t">Tezos_shell_services.History_mode.Legacy.t</a>;</span></code></td></tr></table><code><span>}</span></code></td></tr></table></div></div><div class="odoc-spec"><div class="spec type" id="type-snapshot_format" class="anchored"><a href="#type-snapshot_format" class="anchor"></a><code><span><span class="keyword">type</span> snapshot_format</span><span> = </span></code><table><tr id="type-snapshot_format.Tar" class="anchored"><td class="def variant constructor"><a href="#type-snapshot_format.Tar" class="anchor"></a><code><span>| </span><span><span class="constructor">Tar</span></span></code></td></tr><tr id="type-snapshot_format.Raw" class="anchored"><td class="def variant constructor"><a href="#type-snapshot_format.Raw" class="anchor"></a><code><span>| </span><span><span class="constructor">Raw</span></span></code></td></tr></table></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_snapshot_format" class="anchored"><a href="#val-pp_snapshot_format" class="anchor"></a><code><span><span class="keyword">val</span> pp_snapshot_format : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-snapshot_format">snapshot_format</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-snapshot_format_encoding" class="anchored"><a href="#val-snapshot_format_encoding" class="anchor"></a><code><span><span class="keyword">val</span> snapshot_format_encoding : <span><a href="#type-snapshot_format">snapshot_format</a> <span class="xref-unresolved">Tezos_base__TzPervasives</span>.Data_encoding.t</span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-snapshot_kind" class="anchored"><a href="#type-snapshot_kind" class="anchor"></a><code><span><span class="keyword">type</span> snapshot_kind</span><span> = </span></code><table><tr id="type-snapshot_kind.Current" class="anchored"><td class="def variant constructor"><a href="#type-snapshot_kind.Current" class="anchor"></a><code><span>| </span><span><span class="constructor">Current</span> <span class="keyword">of</span> <a href="#type-snapshot_format">snapshot_format</a></span></code></td></tr><tr id="type-snapshot_kind.Legacy" class="anchored"><td class="def variant constructor"><a href="#type-snapshot_kind.Legacy" class="anchor"></a><code><span>| </span><span><span class="constructor">Legacy</span></span></code></td></tr><tr id="type-snapshot_kind.Invalid" class="anchored"><td class="def variant constructor"><a href="#type-snapshot_kind.Invalid" class="anchor"></a><code><span>| </span><span><span class="constructor">Invalid</span></span></code></td></tr></table></div></div><div class="odoc-spec"><div class="spec value" id="val-metadata_encoding" class="anchored"><a href="#val-metadata_encoding" class="anchor"></a><code><span><span class="keyword">val</span> metadata_encoding : <span><a href="#type-metadata">metadata</a> <span class="xref-unresolved">Tezos_base__TzPervasives</span>.Data_encoding.t</span></span></code></div><div class="spec-doc"><p>Encoding of a snapshot's <a href="#type-metadata"><code>metadata</code></a></p></div></div><div class="odoc-spec"><div class="spec value" id="val-pp_metadata" class="anchored"><a href="#val-pp_metadata" class="anchor"></a><code><span><span class="keyword">val</span> pp_metadata : <span><span class="xref-unresolved">Stdlib</span>.Format.formatter <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-metadata">metadata</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Pretty-printer of a snapshot's <a href="#type-metadata"><code>metadata</code></a></p></div></div><div class="odoc-spec"><div class="spec value" id="val-read_snapshot_metadata" class="anchored"><a href="#val-read_snapshot_metadata" class="anchor"></a><code><span><span class="keyword">val</span> read_snapshot_metadata : <span>snapshot_path:string <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<a href="#type-snapshot_metadata">snapshot_metadata</a>, <span><a href="../../../tezos-error-monad/Tezos_error_monad/TzCore/index.html#type-error">Tezos_error_monad.TzCore.error</a> list</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>read_snapshot_metadata ~snapshot_path</code> reads <code>snapshot_file</code>'s metadata.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-export" class="anchored"><a href="#val-export" class="anchor"></a><code><span><span class="keyword">val</span> export : <span>?snapshot_path:string <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-snapshot_format">snapshot_format</a> <span class="arrow">&#45;&gt;</span></span> <span>?rolling:bool <span class="arrow">&#45;&gt;</span></span> <span>block:<a href="../../../tezos-shell-services/Tezos_shell_services/Block_services/index.html#type-block">Tezos_shell_services.Block_services.block</a> <span class="arrow">&#45;&gt;</span></span> <span>store_dir:string
<span class="arrow">&#45;&gt;</span></span> <span>context_dir:string <span class="arrow">&#45;&gt;</span></span> <span>chain_name:<a href="../../../tezos-base/Tezos_base/Distributed_db_version/Name/index.html#type-t">Tezos_base.Distributed_db_version.Name.t</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../tezos-base/Tezos_base/Genesis/index.html#type-t">Tezos_base.Genesis.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(unit, <span><a href="../../../tezos-error-monad/Tezos_error_monad/TzCore/index.html#type-error">Tezos_error_monad.TzCore.error</a> list</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>export ?snapshot_path snapshot_format ?rolling ~block ~store_dir
   ~context_dir ~chain_name genesis</code> reads from the <code>store_dir</code> and <code>context_dir</code> the current state of the node and produces a snapshot, of the given <code>snapshot_format</code>, in <code>snapshot_file</code> if it is provided. Otherwise, a snapshot file name is automatically generated using the target block as hint. If <code>rolling</code> is set, only the necessary blocks will be exported.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-import" class="anchored"><a href="#val-import" class="anchor"></a><code><span><span class="keyword">val</span> import : <span>snapshot_path:string <span class="arrow">&#45;&gt;</span></span> <span>?patch_context:<span>(<span><a href="../../../tezos-context/Tezos_context/Context/index.html#type-t">Tezos_context.Context.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<a href="../../../tezos-context/Tezos_context/Context/index.html#type-t">Tezos_context.Context.t</a>, <span><a href="../../../tezos-error-monad/Tezos_error_monad/TzCore/index.html#type-error">Tezos_error_monad.TzCore.error</a> list</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span>)</span> <span class="arrow">&#45;&gt;</span></span>
<span>?block:<a href="../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> <span class="arrow">&#45;&gt;</span></span> <span>?check_consistency:bool <span class="arrow">&#45;&gt;</span></span> <span>dst_store_dir:string <span class="arrow">&#45;&gt;</span></span>
<span>dst_context_dir:string <span class="arrow">&#45;&gt;</span></span> <span>chain_name:<a href="../../../tezos-base/Tezos_base/Distributed_db_version/Name/index.html#type-t">Tezos_base.Distributed_db_version.Name.t</a> <span class="arrow">&#45;&gt;</span></span> <span>user_activated_upgrades:<a href="../../../tezos-base/Tezos_base/User_activated/index.html#type-upgrades">Tezos_base.User_activated.upgrades</a> <span class="arrow">&#45;&gt;</span></span>
<span>user_activated_protocol_overrides:<a href="../../../tezos-base/Tezos_base/User_activated/index.html#type-protocol_overrides">Tezos_base.User_activated.protocol_overrides</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../../tezos-base/Tezos_base/Genesis/index.html#type-t">Tezos_base.Genesis.t</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(unit, <span><a href="../../../tezos-error-monad/Tezos_error_monad/TzCore/index.html#type-error">Tezos_error_monad.TzCore.error</a> list</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>import ~snapshot_path ?patch_context ?block ?check_consistency
   ~dst_store_dir ~dst_context_dir chain_name ~user_activated_upgrades
   ~user_activated_protocol_overrides genesis</code> populates <code>dst_store_dir</code> and <code>dst_context_dir</code> with the data contained in the <code>snapshot_file</code>. If <code>check_consistency</code> is unset, less security checks will be made and the import process will be more efficient. If <code>block</code> is set, the import process will make sure that the block is the correct one we load. <code>patch_context</code>, <code>user_activated_upgrades</code> and <code>user_activated_protocol_overrides</code> are passed to the validator in order to validate the target block.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-snapshot_file_kind" class="anchored"><a href="#val-snapshot_file_kind" class="anchor"></a><code><span><span class="keyword">val</span> snapshot_file_kind : <span>snapshot_path:string <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<a href="#type-snapshot_kind">snapshot_kind</a>, <span><a href="../../../tezos-error-monad/Tezos_error_monad/TzCore/index.html#type-error">Tezos_error_monad.TzCore.error</a> list</span>)</span> <span class="xref-unresolved">Stdlib</span>.result</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>snapshot_file_kind ~snapshot_file</code> reads the <code>snapshot_file</code> and returns its kind. Returns <code>Invalid</code> if it is a wrong snapshot file.</p></div></div></div></body></html>