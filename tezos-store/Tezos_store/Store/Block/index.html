<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Block (tezos-store.Tezos_store.Store.Block)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../../../index.html">tezos-store</a> &#x00BB; <a href="../../index.html">Tezos_store</a> &#x00BB; <a href="../index.html">Store</a> &#x00BB; Block</nav><h1>Module <code>Store.Block</code></h1><p>The module for handling block-related operations such as storing and reading data associated to a single block.</p><nav class="toc"><ul><li><a href="#block-field-accessors">Block field accessors</a></li><li><a href="#block-metadata-field-accessors">Block metadata field accessors</a></li></ul></nav></header><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> t</code></dt><dd><p>The abstract type for a block.</p></dd></dl><dl><dt class="spec type" id="type-block"><a href="#type-block" class="anchor"></a><code><span class="keyword">type</span> block</code><code> = <a href="index.html#type-t">t</a></code></dt><dd><p>The type alias for a block.</p></dd></dl><dl><dt class="spec type" id="type-metadata"><a href="#type-metadata" class="anchor"></a><code><span class="keyword">type</span> metadata</code><code> = <a href="../../Block_repr/index.html#type-metadata">Block_repr.metadata</a></code><code> = </code><code>{</code><table class="record"><tr id="type-metadata.message" class="anchored"><td class="def field"><a href="#type-metadata.message" class="anchor"></a><code>message : <span>string option</span>;</code></td></tr><tr id="type-metadata.max_operations_ttl" class="anchored"><td class="def field"><a href="#type-metadata.max_operations_ttl" class="anchor"></a><code>max_operations_ttl : int;</code></td></tr><tr id="type-metadata.last_allowed_fork_level" class="anchored"><td class="def field"><a href="#type-metadata.last_allowed_fork_level" class="anchor"></a><code>last_allowed_fork_level : Stdlib.Int32.t;</code></td></tr><tr id="type-metadata.block_metadata" class="anchored"><td class="def field"><a href="#type-metadata.block_metadata" class="anchor"></a><code>block_metadata : Stdlib.Bytes.t;</code></td></tr><tr id="type-metadata.operations_metadata" class="anchored"><td class="def field"><a href="#type-metadata.operations_metadata" class="anchor"></a><code>operations_metadata : <span><span>Stdlib.Bytes.t list</span> list</span>;</code></td></tr></table><code>}</code></dt><dd><p>The type for block's metadata.</p></dd></dl><dl><dt class="spec value" id="val-equal"><a href="#val-equal" class="anchor"></a><code><span class="keyword">val</span> equal : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>equal b1 b2</code> tests the equality between <code>b1</code> and <code>b2</code>. <b>Warning</b> only block hashes are compared.</p></dd></dl><dl><dt class="spec value" id="val-is_known_valid"><a href="#val-is_known_valid" class="anchor"></a><code><span class="keyword">val</span> is_known_valid : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> <span>&#45;&gt;</span> <span>bool Lwt.t</span></code></dt><dd><p><code>is_known_valid chain_store bh</code> tests that the block <code>bh</code> is known and valid in <code>chain_store</code> (i.e. the block is present in the block store).</p></dd></dl><dl><dt class="spec value" id="val-is_known_invalid"><a href="#val-is_known_invalid" class="anchor"></a><code><span class="keyword">val</span> is_known_invalid : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> <span>&#45;&gt;</span> <span>bool Lwt.t</span></code></dt><dd><p><code>is_known_invalid chain_store bh</code> tests that the block <code>bh</code> is invalid in <code>chain_store</code> (i.e. the block is present in the invalid blocks file).</p></dd></dl><dl><dt class="spec value" id="val-is_known"><a href="#val-is_known" class="anchor"></a><code><span class="keyword">val</span> is_known : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> <span>&#45;&gt;</span> <span>bool Lwt.t</span></code></dt><dd><p><code>is_known chain_store bh</code> tests that the block <code>bh</code> is either known valid or known invalid in <code>chain_store</code>.</p></dd></dl><dl><dt class="spec value" id="val-is_genesis"><a href="#val-is_genesis" class="anchor"></a><code><span class="keyword">val</span> is_genesis : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p><code>is_genesis chain_store bh</code> tests that the block <code>bh</code> is the genesis initialized in <code>chain_store</code>.</p></dd></dl><dl><dt class="spec value" id="val-validity"><a href="#val-validity" class="anchor"></a><code><span class="keyword">val</span> validity : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> <span>&#45;&gt;</span> <span><a href="../../../../tezos-base/Tezos_base/Block_locator/index.html#type-validity">Tezos_base__TzPervasives.Block_locator.validity</a> Lwt.t</span></code></dt><dd><p><code>validity chain_store bh</code> computes the <span class="xref-unresolved" title="unresolved reference to &quot;Block_locator.validity&quot;"><code>Block_locator</code>.validity</span> (<code>Unknown</code>, <code>Known_valid</code> or <code>Known_invalid</code>) for the block <code>bh</code> in <code>chain_store</code>.</p></dd></dl><dl><dt class="spec value" id="val-read_block"><a href="#val-read_block" class="anchor"></a><code><span class="keyword">val</span> read_block : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <span>?&#8288;distance:int</span> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> <span>&#45;&gt;</span> <span><span><a href="index.html#type-block">block</a> <a href="../../../../tezos-base/Tezos_base__TzPervasives/index.html#type-tzresult">Tezos_base__TzPervasives.tzresult</a></span> Lwt.t</span></code></dt><dd><p><code>read_block chain_store ?distance bh</code> tries to read in the <code>chain_store</code> the block <code>bh</code> or the predecessing block at the offset <code>distance</code> of <code>bh</code>. By default, <code>distance</code> is 0.</p></dd></dl><dl><dt class="spec value" id="val-read_block_opt"><a href="#val-read_block_opt" class="anchor"></a><code><span class="keyword">val</span> read_block_opt : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <span>?&#8288;distance:int</span> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> <span>&#45;&gt;</span> <span><span><a href="index.html#type-block">block</a> option</span> Lwt.t</span></code></dt><dd><p><code>read_block_opt chain_store ?distance bh</code> optional version of <code>read_block</code>.</p></dd></dl><dl><dt class="spec value" id="val-read_block_by_level"><a href="#val-read_block_by_level" class="anchor"></a><code><span class="keyword">val</span> read_block_by_level : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <span><span><a href="index.html#type-block">block</a> <a href="../../../../tezos-base/Tezos_base__TzPervasives/index.html#type-tzresult">Tezos_base__TzPervasives.tzresult</a></span> Lwt.t</span></code></dt><dd><p><code>read_block_by_level chain_store level</code> reads in the <code>chain_store</code> the block at <code>level</code>. The block retrieved will be the (level(current_head) - level)-th predecessor of the <code>chain_store</code>'s current head.</p></dd></dl><dl><dt class="spec value" id="val-read_block_by_level_opt"><a href="#val-read_block_by_level_opt" class="anchor"></a><code><span class="keyword">val</span> read_block_by_level_opt : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> <span><span><a href="index.html#type-block">block</a> option</span> Lwt.t</span></code></dt><dd><p><code>read_block_by_level_opt chain_store level</code> optional version of <code>read_block_by_level</code>.</p></dd></dl><dl><dt class="spec value" id="val-read_block_metadata"><a href="#val-read_block_metadata" class="anchor"></a><code><span class="keyword">val</span> read_block_metadata : <span>?&#8288;distance:int</span> <span>&#45;&gt;</span> <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> <span>&#45;&gt;</span> <span><span><span><a href="index.html#type-metadata">metadata</a> option</span> <a href="../../../../tezos-base/Tezos_base__TzPervasives/index.html#type-tzresult">Tezos_base__TzPervasives.tzresult</a></span> Lwt.t</span></code></dt><dd><p><code>read_block_metadata ?distance chain_store bh</code> reads in the <code>chain_store</code> the metadata associated to the block <code>bh</code> or its <code>distance</code>-th predecessor if given. Returns <code>None</code> otherwise. By default, <code>distance</code> is 0.</p><p><b>Warning</b> If the block is already read, prefer the usage of <code>get_block_metadata</code> which will memoize the result.</p></dd></dl><dl><dt class="spec value" id="val-read_block_metadata_opt"><a href="#val-read_block_metadata_opt" class="anchor"></a><code><span class="keyword">val</span> read_block_metadata_opt : <span>?&#8288;distance:int</span> <span>&#45;&gt;</span> <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> <span>&#45;&gt;</span> <span><span><a href="index.html#type-metadata">metadata</a> option</span> Lwt.t</span></code></dt><dd><p><code>read_block_metadata_opt ?distance chain_store bh</code> same as <code>read_block_metadata</code> but returns <code>None</code> in case of errors.</p></dd></dl><dl><dt class="spec value" id="val-get_block_metadata"><a href="#val-get_block_metadata" class="anchor"></a><code><span class="keyword">val</span> get_block_metadata : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <span><span><a href="index.html#type-metadata">metadata</a> <a href="../../../../tezos-base/Tezos_base__TzPervasives/index.html#type-tzresult">Tezos_base__TzPervasives.tzresult</a></span> Lwt.t</span></code></dt><dd><p><code>get_block_metadata chain_store block</code> reads in the <code>chain_store</code> the metadata associated to the <code>block</code>. Returns <code>None</code> if the metadata cannot be retrieved. This function also memoize the result in the <code>block</code> structure so subsequent calls will be disk I/O free.</p></dd></dl><dl><dt class="spec value" id="val-get_block_metadata_opt"><a href="#val-get_block_metadata_opt" class="anchor"></a><code><span class="keyword">val</span> get_block_metadata_opt : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <span><span><a href="index.html#type-metadata">metadata</a> option</span> Lwt.t</span></code></dt><dd><p><code>get_block_metadata_opt chain_store block</code> optional version of <code>get_block_metadata</code></p></dd></dl><dl><dt class="spec value" id="val-read_predecessor"><a href="#val-read_predecessor" class="anchor"></a><code><span class="keyword">val</span> read_predecessor : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <span><span><a href="index.html#type-block">block</a> <a href="../../../../tezos-base/Tezos_base__TzPervasives/index.html#type-tzresult">Tezos_base__TzPervasives.tzresult</a></span> Lwt.t</span></code></dt><dd><p><code>read_predecessor chain_store block</code> reads in the <code>chain_store</code> the direct predecessor of <code>block</code>. Returns <code>None</code> if it cannot be found.</p></dd></dl><dl><dt class="spec value" id="val-read_predecessor_opt"><a href="#val-read_predecessor_opt" class="anchor"></a><code><span class="keyword">val</span> read_predecessor_opt : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <span><span><a href="index.html#type-block">block</a> option</span> Lwt.t</span></code></dt><dd><p><code>read_predecessor_opt chain_store block</code> optional version of <code>read_predecessor</code>.</p></dd></dl><dl><dt class="spec value" id="val-read_predecessor_of_hash"><a href="#val-read_predecessor_of_hash" class="anchor"></a><code><span class="keyword">val</span> read_predecessor_of_hash : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> <span>&#45;&gt;</span> <span><span><a href="index.html#type-block">block</a> <a href="../../../../tezos-base/Tezos_base__TzPervasives/index.html#type-tzresult">Tezos_base__TzPervasives.tzresult</a></span> Lwt.t</span></code></dt><dd><p><code>read_predecessor_of_hash chain_store bh</code> reads in <code>chain_store</code> the predecessor's block of <code>bh</code>.</p></dd></dl><dl><dt class="spec value" id="val-read_ancestor_hash"><a href="#val-read_ancestor_hash" class="anchor"></a><code><span class="keyword">val</span> read_ancestor_hash : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <span>distance:int</span> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> <span>&#45;&gt;</span> <span><span><span><a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> option</span> <a href="../../../../tezos-base/Tezos_base__TzPervasives/index.html#type-tzresult">Tezos_base__TzPervasives.tzresult</a></span> Lwt.t</span></code></dt><dd><p><code>read_ancestor_hash chain_store ~distance bh</code> retrieves in the <code>chain_store</code> the hash of the ancestor of the block <code>bh</code> at <code>distance</code> if it exists. Returns <code>None</code> otherwise.</p></dd></dl><dl><dt class="spec value" id="val-read_ancestor_hash_opt"><a href="#val-read_ancestor_hash_opt" class="anchor"></a><code><span class="keyword">val</span> read_ancestor_hash_opt : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <span>distance:int</span> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> <span>&#45;&gt;</span> <span><span><a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> option</span> Lwt.t</span></code></dt><dd><p><code>read_ancestor_hash_opt chain_store ~distance bh</code> same as <code>read_ancestor_hash</code> but returns <code>None</code> on errors.</p></dd></dl><dl><dt class="spec value" id="val-read_predecessor_of_hash_opt"><a href="#val-read_predecessor_of_hash_opt" class="anchor"></a><code><span class="keyword">val</span> read_predecessor_of_hash_opt : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> <span>&#45;&gt;</span> <span><span><a href="index.html#type-block">block</a> option</span> Lwt.t</span></code></dt><dd><p><code>read_ancestor_opt chain_store block</code> optional version of <code>read_ancestor</code>.</p></dd></dl><dl><dt class="spec value" id="val-store_block"><a href="#val-store_block" class="anchor"></a><code><span class="keyword">val</span> store_block : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <span>block_header:<a href="../../../../tezos-base/Tezos_base/Block_header/index.html#type-t">Tezos_base__TzPervasives.Block_header.t</a></span> <span>&#45;&gt;</span> <span>operations:<span><span><a href="../../../../tezos-base/Tezos_base/Operation/index.html#type-t">Tezos_base__TzPervasives.Operation.t</a> list</span> list</span></span> <span>&#45;&gt;</span> <a href="../../../../tezos-validation/Tezos_validation/Block_validation/index.html#type-result">Tezos_validation.Block_validation.result</a> <span>&#45;&gt;</span> <span><span><span><a href="index.html#type-block">block</a> option</span> <a href="../../../../tezos-base/Tezos_base__TzPervasives/index.html#type-tzresult">Tezos_base__TzPervasives.tzresult</a></span> Lwt.t</span></code></dt><dd><p><code>store_block chain_store ~block_header ~operations
      validation_result</code> stores in <code>chain_store</code> the block with its <code>block_header</code>, <code>operations</code> and validation result. Inconsistent blocks and validation will result in failures. Returns <code>None</code> if the block was already stored. If the block is correctly stored, the newly created block is returned.</p><p><b>Warning</b> The store will refuse to store blocks with no associated context's commit.</p></dd></dl><dl><dt class="spec value" id="val-context_exn"><a href="#val-context_exn" class="anchor"></a><code><span class="keyword">val</span> context_exn : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <span><a href="../../../../tezos-context/Tezos_context/Context/index.html#type-t">Tezos_context.Context.t</a> Lwt.t</span></code></dt><dd><p><code>context_exn chain_store block</code> checkouts the context of the <code>block</code>.</p></dd></dl><dl><dt class="spec value" id="val-context_opt"><a href="#val-context_opt" class="anchor"></a><code><span class="keyword">val</span> context_opt : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <span><span><a href="../../../../tezos-context/Tezos_context/Context/index.html#type-t">Tezos_context.Context.t</a> option</span> Lwt.t</span></code></dt><dd><p><code>context_opt chain_store block</code> optional version of <code>context_exn</code>.</p></dd></dl><dl><dt class="spec value" id="val-context"><a href="#val-context" class="anchor"></a><code><span class="keyword">val</span> context : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <span><span><a href="../../../../tezos-context/Tezos_context/Context/index.html#type-t">Tezos_context.Context.t</a> <a href="../../../../tezos-base/Tezos_base__TzPervasives/index.html#type-tzresult">Tezos_base__TzPervasives.tzresult</a></span> Lwt.t</span></code></dt><dd><p><code>context chain_store block</code> error monad version of <code>context_exn</code>.</p></dd></dl><dl><dt class="spec value" id="val-context_exists"><a href="#val-context_exists" class="anchor"></a><code><span class="keyword">val</span> context_exists : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <span>bool Lwt.t</span></code></dt><dd><p><code>context_exists chain_store block</code> tests the existence of the <code>block</code>'s commit in the context.</p></dd></dl><dl><dt class="spec value" id="val-testchain_status"><a href="#val-testchain_status" class="anchor"></a><code><span class="keyword">val</span> testchain_status : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <span><span><span>(<a href="../../../../tezos-base/Tezos_base/Test_chain_status/index.html#type-t">Tezos_base__TzPervasives.Test_chain_status.t</a> * <span><a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> option</span>)</span> <a href="../../../../tezos-base/Tezos_base__TzPervasives/index.html#type-tzresult">Tezos_base__TzPervasives.tzresult</a></span> Lwt.t</span></code></dt><dd><p><code>testchain_status chain_store block</code> returns the test chain status stored in context of <code>block</code> along with testchain's genesis if the testchain is found <code>Forking</code> or <code>Running</code>.</p></dd></dl><dl><dt class="spec value" id="val-protocol_hash_exn"><a href="#val-protocol_hash_exn" class="anchor"></a><code><span class="keyword">val</span> protocol_hash_exn : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <span><a href="../../../../tezos-crypto/Tezos_crypto/Protocol_hash/index.html#type-t">Tezos_crypto.Protocol_hash.t</a> Lwt.t</span></code></dt><dd><p><code>protocol_hash_exn chain_store block</code> reads the protocol associated to <code>block</code> in its associated context. Fails when the context is unknown.</p></dd></dl><dl><dt class="spec value" id="val-protocol_hash"><a href="#val-protocol_hash" class="anchor"></a><code><span class="keyword">val</span> protocol_hash : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <span><span><a href="../../../../tezos-crypto/Tezos_crypto/Protocol_hash/index.html#type-t">Tezos_crypto.Protocol_hash.t</a> <a href="../../../../tezos-base/Tezos_base__TzPervasives/index.html#type-tzresult">Tezos_base__TzPervasives.tzresult</a></span> Lwt.t</span></code></dt><dd><p><code>protocol_hash chain_store block</code> error monad version of <code>protocol_hash_exn</code>.</p></dd></dl><dl><dt class="spec value" id="val-read_invalid_block_opt"><a href="#val-read_invalid_block_opt" class="anchor"></a><code><span class="keyword">val</span> read_invalid_block_opt : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> <span>&#45;&gt;</span> <span><span><a href="../../Store_types/index.html#type-invalid_block">Store_types.invalid_block</a> option</span> Lwt.t</span></code></dt><dd><p><code>read_invalid_block_opt chain_store bh</code> reads in the <code>chain_store</code> the invalid block <code>bh</code> if it exists.</p></dd></dl><dl><dt class="spec value" id="val-read_invalid_blocks"><a href="#val-read_invalid_blocks" class="anchor"></a><code><span class="keyword">val</span> read_invalid_blocks : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <span><span><a href="../../Store_types/index.html#type-invalid_block">Store_types.invalid_block</a> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/Map/index.html#type-t">Tezos_crypto.Block_hash.Map.t</a></span> Lwt.t</span></code></dt><dd><p><code>read_invalid_blocks chain_store</code> returns the map of all invalid blocks of <code>chain_store</code>.</p></dd></dl><dl><dt class="spec value" id="val-mark_invalid"><a href="#val-mark_invalid" class="anchor"></a><code><span class="keyword">val</span> mark_invalid : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> <span>&#45;&gt;</span> <span>level:int32</span> <span>&#45;&gt;</span> <span><a href="../../../../tezos-base/Tezos_base__TzPervasives/index.html#type-error">Tezos_base__TzPervasives.error</a> list</span> <span>&#45;&gt;</span> <span><span>unit <a href="../../../../tezos-base/Tezos_base__TzPervasives/index.html#type-tzresult">Tezos_base__TzPervasives.tzresult</a></span> Lwt.t</span></code></dt><dd><p><code>mark_invalid chain_store bh ~level errors</code> stores the block <code>bh</code> at <code>level</code> with the given <code>errors</code>. Fails when trying to mark the genesis block as invalid.</p></dd></dl><dl><dt class="spec value" id="val-unmark_invalid"><a href="#val-unmark_invalid" class="anchor"></a><code><span class="keyword">val</span> unmark_invalid : <a href="../index.html#type-chain_store">chain_store</a> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a> <span>&#45;&gt;</span> <span><span>unit <a href="../../../../tezos-base/Tezos_base__TzPervasives/index.html#type-tzresult">Tezos_base__TzPervasives.tzresult</a></span> Lwt.t</span></code></dt><dd><p><code>unmark_invalid chain_store bh</code> unmarks invalid the block <code>bh</code> in the <code>chain_store</code>.</p></dd></dl><dl><dt class="spec value" id="val-descriptor"><a href="#val-descriptor" class="anchor"></a><code><span class="keyword">val</span> descriptor : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <a href="../../Store_types/index.html#type-block_descriptor">Store_types.block_descriptor</a></code></dt><dd><p><code>descriptor block</code> returns the pair (hash x level) of <code>block</code>.</p></dd></dl><section><header><h4 id="block-field-accessors"><a href="#block-field-accessors" class="anchor"></a>Block field accessors</h4></header><dl><dt class="spec value" id="val-hash"><a href="#val-hash" class="anchor"></a><code><span class="keyword">val</span> hash : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a></code></dt><dt class="spec value" id="val-header"><a href="#val-header" class="anchor"></a><code><span class="keyword">val</span> header : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <a href="../../../../tezos-base/Tezos_base/Block_header/index.html#type-t">Tezos_base__TzPervasives.Block_header.t</a></code></dt><dt class="spec value" id="val-operations"><a href="#val-operations" class="anchor"></a><code><span class="keyword">val</span> operations : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <span><span><a href="../../../../tezos-base/Tezos_base/Operation/index.html#type-t">Tezos_base__TzPervasives.Operation.t</a> list</span> list</span></code></dt><dt class="spec value" id="val-shell_header"><a href="#val-shell_header" class="anchor"></a><code><span class="keyword">val</span> shell_header : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <a href="../../../../tezos-base/Tezos_base/Block_header/index.html#type-shell_header">Tezos_base__TzPervasives.Block_header.shell_header</a></code></dt><dt class="spec value" id="val-level"><a href="#val-level" class="anchor"></a><code><span class="keyword">val</span> level : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> int32</code></dt><dt class="spec value" id="val-proto_level"><a href="#val-proto_level" class="anchor"></a><code><span class="keyword">val</span> proto_level : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> int</code></dt><dt class="spec value" id="val-predecessor"><a href="#val-predecessor" class="anchor"></a><code><span class="keyword">val</span> predecessor : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Block_hash/index.html#type-t">Tezos_crypto.Block_hash.t</a></code></dt><dt class="spec value" id="val-timestamp"><a href="#val-timestamp" class="anchor"></a><code><span class="keyword">val</span> timestamp : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <a href="../../../../tezos-base/Tezos_base__Time/Protocol/index.html#type-t">Tezos_base__TzPervasives.Time.Protocol.t</a></code></dt><dt class="spec value" id="val-validation_passes"><a href="#val-validation_passes" class="anchor"></a><code><span class="keyword">val</span> validation_passes : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> int</code></dt><dt class="spec value" id="val-operations_hash"><a href="#val-operations_hash" class="anchor"></a><code><span class="keyword">val</span> operations_hash : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Operation_list_list_hash/index.html#type-t">Tezos_crypto.Operation_list_list_hash.t</a></code></dt><dt class="spec value" id="val-fitness"><a href="#val-fitness" class="anchor"></a><code><span class="keyword">val</span> fitness : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <a href="../../../../tezos-base/Tezos_base/Fitness/index.html#type-t">Tezos_base__TzPervasives.Fitness.t</a></code></dt><dt class="spec value" id="val-context_hash"><a href="#val-context_hash" class="anchor"></a><code><span class="keyword">val</span> context_hash : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <a href="../../../../tezos-crypto/Tezos_crypto/Context_hash/index.html#type-t">Tezos_crypto.Context_hash.t</a></code></dt><dt class="spec value" id="val-protocol_data"><a href="#val-protocol_data" class="anchor"></a><code><span class="keyword">val</span> protocol_data : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> bytes</code></dt><dt class="spec value" id="val-block_metadata_hash"><a href="#val-block_metadata_hash" class="anchor"></a><code><span class="keyword">val</span> block_metadata_hash : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <span><a href="../../../../tezos-crypto/Tezos_crypto/Block_metadata_hash/index.html#type-t">Tezos_crypto.Block_metadata_hash.t</a> option</span></code></dt><dt class="spec value" id="val-operations_metadata_hashes"><a href="#val-operations_metadata_hashes" class="anchor"></a><code><span class="keyword">val</span> operations_metadata_hashes : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <span><span><span><a href="../../../../tezos-crypto/Tezos_crypto/Operation_metadata_hash/index.html#type-t">Tezos_crypto.Operation_metadata_hash.t</a> list</span> list</span> option</span></code></dt><dt class="spec value" id="val-operations_metadata_hashes_path"><a href="#val-operations_metadata_hashes_path" class="anchor"></a><code><span class="keyword">val</span> operations_metadata_hashes_path : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span><span><a href="../../../../tezos-crypto/Tezos_crypto/Operation_metadata_hash/index.html#type-t">Tezos_crypto.Operation_metadata_hash.t</a> list</span> option</span></code></dt><dt class="spec value" id="val-all_operations_metadata_hash"><a href="#val-all_operations_metadata_hash" class="anchor"></a><code><span class="keyword">val</span> all_operations_metadata_hash : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <span><a href="../../../../tezos-crypto/Tezos_crypto/Operation_metadata_list_list_hash/index.html#type-t">Tezos_crypto.Operation_metadata_list_list_hash.t</a> option</span></code></dt></dl></section><section><header><h4 id="block-metadata-field-accessors"><a href="#block-metadata-field-accessors" class="anchor"></a>Block metadata field accessors</h4></header><dl><dt class="spec value" id="val-message"><a href="#val-message" class="anchor"></a><code><span class="keyword">val</span> message : <a href="index.html#type-metadata">metadata</a> <span>&#45;&gt;</span> <span>string option</span></code></dt><dt class="spec value" id="val-max_operations_ttl"><a href="#val-max_operations_ttl" class="anchor"></a><code><span class="keyword">val</span> max_operations_ttl : <a href="index.html#type-metadata">metadata</a> <span>&#45;&gt;</span> int</code></dt><dt class="spec value" id="val-last_allowed_fork_level"><a href="#val-last_allowed_fork_level" class="anchor"></a><code><span class="keyword">val</span> last_allowed_fork_level : <a href="index.html#type-metadata">metadata</a> <span>&#45;&gt;</span> int32</code></dt><dt class="spec value" id="val-block_metadata"><a href="#val-block_metadata" class="anchor"></a><code><span class="keyword">val</span> block_metadata : <a href="index.html#type-metadata">metadata</a> <span>&#45;&gt;</span> bytes</code></dt><dt class="spec value" id="val-operations_metadata"><a href="#val-operations_metadata" class="anchor"></a><code><span class="keyword">val</span> operations_metadata : <a href="index.html#type-metadata">metadata</a> <span>&#45;&gt;</span> <span><span>bytes list</span> list</span></code></dt><dt class="spec value" id="val-operations_path"><a href="#val-operations_path" class="anchor"></a><code><span class="keyword">val</span> operations_path : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span><a href="../../../../tezos-base/Tezos_base/Operation/index.html#type-t">Tezos_base__TzPervasives.Operation.t</a> list</span> * <a href="../../../../tezos-crypto/Tezos_crypto/Operation_list_list_hash/index.html#type-path">Tezos_crypto.Operation_list_list_hash.path</a></code></dt><dd><p><code>operations_path block nth</code> computes the <code>nth</code> operations list of <code>block</code> along with the hash of all operations.</p></dd></dl><dl><dt class="spec value" id="val-operations_hashes_path"><a href="#val-operations_hashes_path" class="anchor"></a><code><span class="keyword">val</span> operations_hashes_path : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> <span><a href="../../../../tezos-crypto/Tezos_crypto/Operation_hash/index.html#type-t">Tezos_crypto.Operation_hash.t</a> list</span> * <a href="../../../../tezos-crypto/Tezos_crypto/Operation_list_list_hash/index.html#type-path">Tezos_crypto.Operation_list_list_hash.path</a></code></dt><dd><p><code>operations_hashes_path block nth</code> computes the <code>nth</code> operations hash list of <code>block</code> along with the hash of all operations.</p></dd></dl><dl><dt class="spec value" id="val-all_operation_hashes"><a href="#val-all_operation_hashes" class="anchor"></a><code><span class="keyword">val</span> all_operation_hashes : <a href="index.html#type-block">block</a> <span>&#45;&gt;</span> <span><span><a href="../../../../tezos-crypto/Tezos_crypto/Operation_hash/index.html#type-t">Tezos_crypto.Operation_hash.t</a> list</span> list</span></code></dt><dd><p><code>all_operation_hashes block</code> computes the hash of all operations in <code>block</code>.</p></dd></dl></section></div></body></html>